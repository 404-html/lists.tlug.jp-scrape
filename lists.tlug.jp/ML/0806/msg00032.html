<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [tlug] Clamav reports a virus: Exploit.Gif.PHPembedded -->
<!--X-From-R13: "Sqzhaq Sqtne" <yvfgfNrqbpuna.pbz> -->
<!--X-Date: Thu, 05 Jun 2008 14:40:37 +0900 -->
<!--X-Message-Id: b4d277190806042240l1b0d2cadme275cf77dccdd79a@mail.gmail.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 78d7dd350806042138r226b625do6f30eb68cc80e732@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="Author" content="Jim Tittsler - listmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<P>
<TABLE BGCOLOR="#FFFF66" BORDER=1 COLS=1 WIDTH="90%" CLASS=navbar>
<TR>
<TD>&nbsp;&nbsp;
<FONT FACE="Verdana, Lucida Sans, Arial, Helvetica, Geneva, sans-serif"><SMALL>
<A HREF="../../index.html" TITLE="Tokyo Linux Users Group Page">
<STRONG>tlug.jp</STRONG></A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../../list.html" TITLE="Mailing List Page">Mailing List</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../index.html" TITLE="tlug Archive Page">tlug archive</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
tlug Mailing List Archive
</SMALL></FONT>
</TD></TR>
</TABLE>
<P>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00031.html">Date Prev</a>][<a href="msg00033.html">Date Next</a>][<a href="msg00031.html">Thread Prev</a>][<a href="msg00033.html">Thread Next</a>][<a href="maillist.html#00032">Date Index</a>][<a href="threads.html#00032">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [tlug] Clamav reports a virus: Exploit.Gif.PHPembedded</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li>Date: Thu, 5 Jun 2008 14:40:36 +0900</li>
<li><strong>From</strong>: <strong>&quot;Edmund Edgar&quot; &lt;<a href="mailto:lists@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Clamav%20reports%20a%20virus:%20Exploit.Gif.PHPembedded">lists@example.com</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [tlug] Clamav reports a virus: Exploit.Gif.PHPembedded</strong></li>
<li>References: &lt;<a href="msg00031.html">78d7dd350806042138r226b625do6f30eb68cc80e732@mail.gmail.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>What you've got there is a JPEG image with some PHP code in the
comment field. (In this case not very harmful in itself - I think this
is just intended as proof of concept or something:)
&lt;?php system('ls -la'); ?&gt;

Since it contains valid PHP code, and PHP just prints anything outside
the brackets, that PHP code will run on your system if you tell PHP to
execute the file.

One possible motivation behind making something like this is that you
may be able to upload images to a server where you wouldn't be able to
upload a regular PHP file. Having uploaded it, you can then use
another method to execute the code it contains.

For example, some insecurely written web applications will check if an
uploaded image file has the type it's supposed to have, by looking at
the contents of the file, then assume that if it's an image they don't
have to check anything else. But their web server decides how to
handle the file based on its extension, rather than its contents. So
someone could make a JPEG containing the commands they wanted to run
on your server, rename it &quot;myexploit.php&quot;, upload it and hit its URL
with their browser, thus executing their code on the server.

On a related note, there was a really nasty exploit a while back with
IE where the browser would actually ignore the MIME type specified in
the headers the server sent for an image, and look at the contents of
the file itself to decide what to do with it. You could make a JPEG
file with Javascript in the comment field, post the image to a
bulletin board and get that Javascript run by the browser. This was
unpatched for quite a while IIRC - amazing it didn't do more damage
than it did.

Edmund Edgar
lists@example.com
<a  href="http://www.socialminds.jp">http://www.socialminds.jp</a>
<a  href="http://www.edochan.com">http://www.edochan.com</a>
<a  href="http://www.linkedin.com/in/edmundedgar">http://www.linkedin.com/in/edmundedgar</a>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00033" href="msg00033.html">Re: [tlug] Clamav reports a virus: Exploit.Gif.PHPembedded</a></strong>
<ul><li><em>From:</em> Hung Nguyen Vu</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00031" href="msg00031.html">[tlug] Clamav reports a virus: Exploit.Gif.PHPembedded</a></strong>
<ul><li><em>From:</em> Hung Nguyen Vu</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00031.html">[tlug] Clamav reports a virus: Exploit.Gif.PHPembedded</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00033.html">Re: [tlug] Clamav reports a virus: Exploit.Gif.PHPembedded</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00031.html">[tlug] Clamav reports a virus: Exploit.Gif.PHPembedded</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00033.html">Re: [tlug] Clamav reports a virus: Exploit.Gif.PHPembedded</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00032"><strong>Date</strong></a></li>
<li><a href="threads.html#00032"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
