<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [tlug] How to proceed with RAID drive failure -->
<!--X-From-R13: Oggvyn Yvanyv <nggvynNxvanyv.pu> -->
<!--X-Date: Wed, 13 Jul 2011 22:12:48 +0900 -->
<!--X-Message-Id: 20110713150311.57b6a0cb.attila@kinali.ch -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: CA+kCxRZLF78pq0C41vH2tT5KfPndzwxxPJQs&#45;KF&#45;FMs9iN2tkw@mail.gmail.com -->
<!--X-Reference: 87hb6st4bs.fsf@uwakimon.sk.tsukuba.ac.jp -->
<!--X-Reference: CA+kCxRaMoCfeuWm6fA+dDUpsd0TxF1H6t&#45;mL41GuqdO7U5ucmA@mail.gmail.com -->
<!--X-Reference: CAFv52OC5HLxUTs1dgqXa=RSCYfGMH4Jktu1Uei0Py82yQ8vh1g@mail.gmail.com -->
<!--X-Reference: CA+kCxRb&#45;qROMGDp6c=sihoW&#45;R&#45;8W7&#45;6ydVkniKJFcU299r+z9w@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="Author" content="Jim Tittsler - listmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<P>
<TABLE BGCOLOR="#FFFF66" BORDER=1 COLS=1 WIDTH="90%" CLASS=navbar>
<TR>
<TD>&nbsp;&nbsp;
<FONT FACE="Verdana, Lucida Sans, Arial, Helvetica, Geneva, sans-serif"><SMALL>
<A HREF="../../index.html" TITLE="Tokyo Linux Users Group Page">
<STRONG>tlug.jp</STRONG></A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../../list.html" TITLE="Mailing List Page">Mailing List</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../index.html" TITLE="tlug Archive Page">tlug archive</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
tlug Mailing List Archive
</SMALL></FONT>
</TD></TR>
</TABLE>
<P>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00027.html">Date Prev</a>][<a href="msg00029.html">Date Next</a>][<a href="msg00049.html">Thread Prev</a>][<a href="msg00029.html">Thread Next</a>][<a href="maillist.html#00028">Date Index</a>][<a href="threads.html#00028">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [tlug] How to proceed with RAID drive failure</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li>Date: Wed, 13 Jul 2011 15:03:11 +0200</li>
<li><strong>From</strong>: <strong>Attila Kinali &lt;<a href="mailto:attila@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20How%20to%20proceed%20with%20RAID%20drive%20failure">attila@example.com</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [tlug] How to proceed with RAID drive failure</strong></li>
<li>References: &lt;<a href="mailto:CA%2BkCxRZLF78pq0C41vH2tT5KfPndzwxxPJQs-KF-FMs9iN2tkw@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20How%20to%20proceed%20with%20RAID%20drive%20failure">CA+kCxRZLF78pq0C41vH2tT5KfPndzwxxPJQs-KF-FMs9iN2tkw@example.com</a>&gt;	&lt;<a href="mailto:87hb6st4bs.fsf@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20How%20to%20proceed%20with%20RAID%20drive%20failure">87hb6st4bs.fsf@example.com</a>&gt;	&lt;<a href="mailto:CA%2BkCxRaMoCfeuWm6fA%2BdDUpsd0TxF1H6t-mL41GuqdO7U5ucmA@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20How%20to%20proceed%20with%20RAID%20drive%20failure">CA+kCxRaMoCfeuWm6fA+dDUpsd0TxF1H6t-mL41GuqdO7U5ucmA@example.com</a>&gt;	&lt;<a href="mailto:CAFv52OC5HLxUTs1dgqXa%3DRSCYfGMH4Jktu1Uei0Py82yQ8vh1g@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20How%20to%20proceed%20with%20RAID%20drive%20failure">CAFv52OC5HLxUTs1dgqXa=RSCYfGMH4Jktu1Uei0Py82yQ8vh1g@example.com</a>&gt;	&lt;<a href="mailto:CA%2BkCxRb-qROMGDp6c%3DsihoW-R-8W7-6ydVkniKJFcU299r%2Bz9w@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20How%20to%20proceed%20with%20RAID%20drive%20failure">CA+kCxRb-qROMGDp6c=sihoW-R-8W7-6ydVkniKJFcU299r+z9w@example.com</a>&gt;</li>
<li>Organization: GEHIRN</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On Wed, 13 Jul 2011 21:08:14 +0900
Martin G &lt;ebisumartin@example.com&gt; wrote:

&gt; As you suggested, I unplugged one drive at a time, rebooted, and the one
&gt; that didn't work was the one I replaced.
&gt; 
&gt; I managed to get a drive of almost exactly the same specs. It's plugged in
&gt; now, and according to the partition manager, it's all unallocated space so
&gt; far. I was kind of hoping that there might be some kind of automagic
&gt; detection and setup, but it doesn't look like that's going to happen.
&gt; 
&gt; It's a software RAID that was put together from the Ubuntu alternative
&gt; install CD when I first installed Ubuntu on this machine, so I'm assuming
&gt; there's some configuration tool somewhere that I can use to get the new
&gt; drive to mirror the old drive, but beats me where the heck that is.

That's the one of the two big disadvantages of software RAID, there
is no automagic reconstruction, because the RAID system does not
know whether a drive will end up in the RAID or whether it will be
used for something else.

If you have a RAID1, then both disks were most probably set up the same way,
ie you can copy the partition table over to the new disk and rebuild the RAID.

You can use
sfdisk -d /dev/source | sfdisk /dev/dest
to copy the partition table over
or, if you are using GPT
sgdisk -R /dev/dest /dev/source # copy partition table, be carefull about order
sgdisk -G /dev/dest # randomize the GUIDs

an then it's a 
mdadm --add /dev/mdX /dev/destY 
where X and Y are the &quot;partition&quot; numbers you were using.

Also check whether you had any non-RAID partitions (like for swap),
those have to be initialized on their own (mkswap).

While the RAID is recovering from the failure, you can watch its
progress at /proc/mdstat

HTH

			Attila Kinali



-- 
The trouble with you, Shev, is you don't say anything until you've saved
up a whole truckload of damned heavy brick arguments and then you dump
them all out and never look at the bleeding body mangled beneath the heap
		-- Tirin, The Dispossessed, U. Le Guin

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00029" href="msg00029.html">Re: [tlug] How to proceed with RAID drive failure</a></strong>
<ul><li><em>From:</em> Josh Glover</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00017" href="msg00017.html">[tlug] How to proceed with RAID drive failure</a></strong>
<ul><li><em>From:</em> Martin G</li></ul></li>
<li><strong><a name="00019" href="msg00019.html">[tlug]  How to proceed with RAID drive failure</a></strong>
<ul><li><em>From:</em> Stephen J. Turnbull</li></ul></li>
<li><strong><a name="00023" href="msg00023.html">Re: [tlug] How to proceed with RAID drive failure</a></strong>
<ul><li><em>From:</em> Martin G</li></ul></li>
<li><strong><a name="00025" href="msg00025.html">Re: [tlug] How to proceed with RAID drive failure</a></strong>
<ul><li><em>From:</em> Josh Glover</li></ul></li>
<li><strong><a name="00026" href="msg00026.html">Re: [tlug] How to proceed with RAID drive failure</a></strong>
<ul><li><em>From:</em> Martin G</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00027.html">Re: [tlug] How to proceed with RAID drive failure</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00029.html">Re: [tlug] How to proceed with RAID drive failure</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00049.html">Re: [tlug] How to proceed with RAID drive failure</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00029.html">Re: [tlug] How to proceed with RAID drive failure</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00028"><strong>Date</strong></a></li>
<li><a href="threads.html#00028"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="/list.html"> Mailing List </a></td>
<td align=center><a href="http://tlug.jp/linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="http://tlug.jp/members.html">TLUG Members</a></td>
<td align=center><a href="http://tlug.jp//linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
