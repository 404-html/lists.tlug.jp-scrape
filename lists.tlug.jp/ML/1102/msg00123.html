<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [tlug] Ubuntu server, Windows 7 client, and the firewall between them -->
<!--X-From-R13: Rnir [ U <qnirNnegvpynff.bet> -->
<!--X-Date: Tue, 15 Feb 2011 19:55:14 +0900 -->
<!--X-Message-Id: 4D5A5B8F.9030703@articlass.org -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 4D58FA80.90409@articlass.org -->
<!--X-Reference: AANLkTimk+rjxMNCpHGNTqdw4x=zt0kjy51RYOm+aW8a9@mail.gmail.com -->
<!--X-Reference: 4D595238.6030000@articlass.org -->
<!--X-Reference: AANLkTi=sJgxVh3v&#45;Cqwd7WCXOHxJJs8+m5AR&#45;HnQ3Uo8@mail.gmail.com -->
<!--X-Reference: 4D5A0A79.7080809@articlass.org -->
<!--X-Reference: AANLkTi=tnbSSHXMvUVuUWZ557T1AQsQprF07p0=JJcog@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="Author" content="Jim Tittsler - listmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<P>
<TABLE BGCOLOR="#FFFF66" BORDER=1 COLS=1 WIDTH="90%" CLASS=navbar>
<TR>
<TD>&nbsp;&nbsp;
<FONT FACE="Verdana, Lucida Sans, Arial, Helvetica, Geneva, sans-serif"><SMALL>
<A HREF="../../index.html" TITLE="Tokyo Linux Users Group Page">
<STRONG>tlug.jp</STRONG></A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../../list.html" TITLE="Mailing List Page">Mailing List</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../index.html" TITLE="tlug Archive Page">tlug archive</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
tlug Mailing List Archive
</SMALL></FONT>
</TD></TR>
</TABLE>
<P>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00122.html">Date Prev</a>][<a href="msg00124.html">Date Next</a>][<a href="msg00122.html">Thread Prev</a>][<a href="msg00127.html">Thread Next</a>][<a href="maillist.html#00123">Date Index</a>][<a href="threads.html#00123">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [tlug] Ubuntu server, Windows 7 client, and the firewall between them</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li>Date: Tue, 15 Feb 2011 19:55:11 +0900</li>
<li><strong>From</strong>: <strong>Dave M G &lt;<a href="mailto:dave@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Ubuntu%20server%2C%20Windows%207%20client%2C%20and%20the%20firewall%20between%20them">dave@example.com</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [tlug] Ubuntu server, Windows 7 client, and the firewall between them</strong></li>
<li>References: &lt;<a href="mailto:4D58FA80.90409@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Ubuntu%20server%2C%20Windows%207%20client%2C%20and%20the%20firewall%20between%20them">4D58FA80.90409@example.com</a>&gt;	&lt;<a href="mailto:AANLkTimk%2BrjxMNCpHGNTqdw4x%3Dzt0kjy51RYOm%2BaW8a9@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Ubuntu%20server%2C%20Windows%207%20client%2C%20and%20the%20firewall%20between%20them">AANLkTimk+rjxMNCpHGNTqdw4x=zt0kjy51RYOm+aW8a9@example.com</a>&gt;	&lt;<a href="mailto:4D595238.6030000@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Ubuntu%20server%2C%20Windows%207%20client%2C%20and%20the%20firewall%20between%20them">4D595238.6030000@example.com</a>&gt;	&lt;<a href="mailto:AANLkTi%3DsJgxVh3v-Cqwd7WCXOHxJJs8%2Bm5AR-HnQ3Uo8@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Ubuntu%20server%2C%20Windows%207%20client%2C%20and%20the%20firewall%20between%20them">AANLkTi=sJgxVh3v-Cqwd7WCXOHxJJs8+m5AR-HnQ3Uo8@example.com</a>&gt;	&lt;<a href="mailto:4D5A0A79.7080809@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Ubuntu%20server%2C%20Windows%207%20client%2C%20and%20the%20firewall%20between%20them">4D5A0A79.7080809@example.com</a>&gt;	&lt;<a href="mailto:AANLkTi%3DtnbSSHXMvUVuUWZ557T1AQsQprF07p0%3DJJcog@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Ubuntu%20server%2C%20Windows%207%20client%2C%20and%20the%20firewall%20between%20them">AANLkTi=tnbSSHXMvUVuUWZ557T1AQsQprF07p0=JJcog@example.com</a>&gt;</li>
<li>User-agent: Mozilla/5.0 (X11; U; Linux i686; en-US;	rv:1.9.2.13) Gecko/20101208 Thunderbird/3.1.7</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Romeo, Stephen, Simon,

Thank you guys for responding and providing guidance.

I hope that I sanitized my samba config file enough to display here. I
didn't see anything that looked like it would give away any information
that could be a security problem for me, but maybe I just don't know
what I'm looking at. In any case, I stripped out all the comments for
brevity, and I've included it at the bottom of this message. (If I have
inadvertently put in something that should not be posted publicly,
perhaps a moderator could be so kind as to remove the message...?)

I also had a file in my home directory:

$ more /home/dave/.smb/smb.conf
[global]
client lanman auth = yes
lanman auth = yes
name resolve order = bcast host
dos charset = CP850
workgroup = HOMEGROUP

At first it had the wrong workgroup in it, so I fixed it and then
rebooted both computers, but no joy. What I'm showing you here is how it
currently is, and it has the correct workgroup.

Now that I know I need to be root to run the lsof commands, here is
their output:

dave@example.com:~$ sudo lsof -i :445
COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
smbd    1209 root   24u  IPv4   9046      0t0  TCP *:microsoft-ds (LISTEN)
dave@example.com:~$ sudo lsof -i :137
COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
nmbd    2397 root    9u  IPv4  10248      0t0  UDP *:netbios-ns
nmbd    2397 root   11u  IPv4  10251      0t0  UDP homebase:netbios-ns
nmbd    2397 root   12u  IPv4  10252      0t0  UDP 192.168.0.255:netbios-ns
dave@example.com:~$ sudo lsof -i :138
COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
nmbd    2397 root   10u  IPv4  10249      0t0  UDP *:netbios-dgm
nmbd    2397 root   13u  IPv4  10253      0t0  UDP homebase:netbios-dgm
nmbd    2397 root   14u  IPv4  10254      0t0  UDP
192.168.0.255:netbios-dgm
dave@example.com:~$ sudo lsof -i :139
COMMAND  PID USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
smbd    1209 root   25u  IPv4   9048      0t0  TCP *:netbios-ssn (LISTEN)

So... uh... does all this look healthy?

smb.conf:

[global]
   workgroup = HOMEGROUP
   server string = %h server (Samba, Ubuntu)
;   wins server = w.x.y.z
   dns proxy = no
;   name resolve order = lmhosts host wins bcast
;   interfaces = 127.0.0.0/8 eth0
;   bind interfaces only = yes
   log file = /var/log/samba/log.%m
   max log size = 1000
   syslog = 0
   panic action = /usr/share/samba/panic-action %d
   encrypt passwords = true
   passdb backend = tdbsam
   obey pam restrictions = yes
   unix password sync = yes
   passwd program = /usr/bin/passwd %u
   passwd chat = *Enter\snew\s*\spassword:* %n\n
*Retype\snew\s*\spassword:* %n\n *password\supdated\ssuccessfully* .
   pam password change = yes
   map to guest = bad user
;   domain logons = yes
;   logon path = \\%N\profiles\%U
;   logon drive = H:
;   logon script = logon.cmd
; add user script = /usr/sbin/adduser --quiet --disabled-password
--gecos &quot;&quot; %u
; add machine script  = /usr/sbin/useradd -g machines -c &quot;%u machine
account&quot; -d /var/lib/samba -s /bin/false %u
; add group script = /usr/sbin/addgroup --force-badname %g
;   printing = bsd
;   printcap name = /etc/printcap
;   printing = cups
;   printcap name = cups
;   include = /home/samba/etc/smb.conf.%m
;   message command = /bin/sh -c '/usr/bin/linpopup &quot;%f&quot; &quot;%m&quot; %s; rm %s' &amp;
;   idmap uid = 10000-20000
;   idmap gid = 10000-20000
;   template shell = /bin/bash
;   winbind enum groups = yes
;   winbind enum users = yes
;   usershare max shares = 100
   usershare allow guests = yes
;[homes]
;   comment = Home Directories
;   browseable = no
;   read only = yes
;   create mask = 0700
;   directory mask = 0700
;   valid users = %S
;[netlogon]
;   comment = Network Logon Service
;   path = /home/samba/netlogon
;   guest ok = yes
;   read only = yes
;   share modes = no
;[profiles]
;   comment = Users profiles
;   path = /home/samba/profiles
;   guest ok = no
;   browseable = no
;   create mask = 0600
;   directory mask = 0700
[printers]
   comment = All Printers
   browseable = no
   path = /var/spool/samba
   printable = yes
   guest ok = no
   read only = yes
   create mask = 0700
[print$]
   comment = Printer Drivers
   path = /var/lib/samba/printers
   browseable = yes
   read only = yes
   guest ok = no
;   write list = root, @lpadmin
;[cdrom]
;   comment = Samba server's CD-ROM
;   read only = yes
;   locking = no
;   path = /cdrom
;   guest ok = yes
;   preexec = /bin/mount /cdrom
;   postexec = /bin/umount /cdrom

-- 
Dave M G

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00127" href="msg00127.html">Re: [tlug] Ubuntu server, Windows 7 client, and the firewall between them [SOLVED]</a></strong>
<ul><li><em>From:</em> Dave M G</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00107" href="msg00107.html">[tlug] Ubuntu server, Windows 7 client,	and the firewall between them</a></strong>
<ul><li><em>From:</em> Dave M G</li></ul></li>
<li><strong><a name="00108" href="msg00108.html">Re: [tlug] Ubuntu server, Windows 7 client,	and the firewall between them</a></strong>
<ul><li><em>From:</em> Romeo Theriault</li></ul></li>
<li><strong><a name="00110" href="msg00110.html">Re: [tlug] Ubuntu server, Windows 7 client, and the firewall between them</a></strong>
<ul><li><em>From:</em> Dave M G</li></ul></li>
<li><strong><a name="00113" href="msg00113.html">Re: [tlug] Ubuntu server, Windows 7 client,	and the firewall between them</a></strong>
<ul><li><em>From:</em> Romeo Theriault</li></ul></li>
<li><strong><a name="00118" href="msg00118.html">Re: [tlug] Ubuntu server, Windows 7 client, and the firewall between them</a></strong>
<ul><li><em>From:</em> Dave M G</li></ul></li>
<li><strong><a name="00122" href="msg00122.html">Re: [tlug] Ubuntu server, Windows 7 client,	and the firewall between them</a></strong>
<ul><li><em>From:</em> Romeo Theriault</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00122.html">Re: [tlug] Ubuntu server, Windows 7 client,	and the firewall between them</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00124.html">Re: [tlug] Are ordered hashes useful?</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00122.html">Re: [tlug] Ubuntu server, Windows 7 client,	and the firewall between them</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00127.html">Re: [tlug] Ubuntu server, Windows 7 client, and the firewall between them [SOLVED]</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00123"><strong>Date</strong></a></li>
<li><a href="threads.html#00123"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="/list.html"> Mailing List </a></td>
<td align=center><a href="http://tlug.jp/linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="http://tlug.jp/members.html">TLUG Members</a></td>
<td align=center><a href="http://tlug.jp//linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
