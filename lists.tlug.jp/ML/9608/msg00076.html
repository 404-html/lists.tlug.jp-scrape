<!-- MHonArc v2.2.0 -->
<!--X-Subject: Re: Building a 2.0 kernel -->
<!--X-From: turnbull@example.com (Stephen J. Turnbull) -->
<!--X-Date:  Mon, 26 Aug 1996 08:57:44 GMT -->
<!--X-Message-Id: m0uuxSG&#45;000010C@example.com -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 199608260807.RAA01744@example.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-type" content="text/html">
  <meta name="Author" content="Jim Schweizer - webmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<!--X-Body-Begin-->
<!--X-User-Header-->
<P>
<font color="blue">
Support open source code!
</font>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00075.html">Date Prev</A>][<A HREF="msg00077.html">Date Next</A>][<A HREF="msg00075.html">Thread Prev</A>][<A HREF="msg00078.html">Thread Next</A>][<A HREF="maillist.html#00076">Date Index</A>][<A HREF="threads.html#00076">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: Building a 2.0 kernel</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong><A HREF="mailto:tlug@example.com">tlug@example.com</A></strong></LI>
<LI><strong>Subject</strong>: <strong>Re: Building a 2.0 kernel</strong></LI>
<LI><strong>From</strong>: <strong><A HREF="mailto:turnbull@example.com">turnbull@example.com</A> (Stephen J. Turnbull)</strong></LI>
<LI>Date: Mon, 26 Aug 96 17:55 JST</LI>
<LI>In-Reply-To: &lt;<A HREF="msg00075.html">199608260807.RAA01744@example.com</A>&gt; (schweiz@example.com)</LI>
<LI>Reply-To: <A HREF="mailto:tlug@example.com">tlug@example.com</A></LI>
<LI>Sender: <A HREF="mailto:owner-tlug@example.com">owner-tlug@example.com</A></LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
&gt;&gt;&gt;&gt;&gt; "Jim" == Jim Schweizer &lt;schweiz@example.com&gt; writes:

    Jim&gt; Hi all, Thanks for the advice, Steve - I know what I'm doing
    Jim&gt; until the wee hours tonight;-)

He he.

    Jim&gt; I decided to take your advice and try to build a more recent
    Jim&gt; kernel so I fetched linux-2.0.tar.gz off the July Mo' Linux
    Jim&gt; CD-ROM and untarred it in /usr/src figuring it would unpack

Yep.  That's an oops.  I *always* do "tar tzf nantoka.tar.gz | head"
before unpacking anything.

    Jim&gt; into something like /usr/src/linuxelf-2.0.  It didn't. It

That's logical and safe.  Unfortunately, that's not the way Linus does
it.  Unfortunately, lots of other people don't do it that way either.
"tar tzf" is your buddy.

    Jim&gt; unpacked into /usr/src/linux which, as you'll recall, was a
    Jim&gt; symlink to linuxelf-1.2.13. Is this a problem? (I'm *sure*
    Jim&gt; that's a Newbie question &lt;grin&gt;)

Since you've got the relevant CD-ROMs, your best bet is to "rm -r
/usr/src/linux*"---or a more cautious equivalent ;-) and re-untar.
The linuxelf-1.2.13 should be in a tar file by that name somewhere on
the slackware distribution; or you could reinstall from the Slackware
setup program.  It also probably untars into ./linux, though; be
careful when you do that (if you do---if you have any luck with 2.0,
you probably won't go back).

    Jim&gt; Wish me luck.....

Good luck!  And a few words of advice:

Don't do build any modules; it's not hard, but you need the new
modules distribution for 2.0.  That requires untarring the kernel
sources, building the module support programs, and only then building
the kernel.  Or maybe you have to build the kernel first, and then
rebuild it after building the module programs.  Just avoid that
headache---if you want it in your kernel, put it in the kernel, not as
a loadable module.  You can deal with the module issue later.

Keep your old kernel around; you are going to have to upgrade a number 
of utilities for v2.0.0 (eg, the old series of ps tools don't work
right with new kernels; file locking changed so Smail gets downright
buggy).  I forget the list; here are a couple of things from my
Bookmarks file that should help:

    &lt;H3&gt;Linux&lt;/H3&gt;
    &lt;DL&gt;&lt;p&gt;
        &lt;DT&gt;&lt;A HREF="<A TARGET="_top" HREF="http://www.singnet.com.sg/~sunsurf/linux11.html">http://www.singnet.com.sg/~sunsurf/linux11.html</A>"&gt;
               <A TARGET="_top" HREF="http://www.singnet.com.sg/~sunsurf/linux11.html">http://www.singnet.com.sg/~sunsurf/linux11.html</A>&lt;/A&gt;
        &lt;DT&gt;&lt;A HREF="<A TARGET="_top" HREF="http://puck.nether.net/~jared/victim.html">http://puck.nether.net/~jared/victim.html</A>"&gt;
               Software Uvatims of the 1.3 Kernel Development&lt;/A&gt;
        &lt;DT&gt;&lt;A HREF="<A TARGET="_top" HREF="http://netrom.com/~soul/">http://netrom.com/~soul/</A>"&gt;
               Mikes's Linux WeB Page&lt;/A&gt;
    &lt;/DL&gt;

(you might be able to just suck this message into Netscape and go from
there...).  "Software Uvatims" is especially relevant.

However, you should be able to boot and play with the 2.0.0 kernel
even if not all the system software works perfectly.  So just copy the
new kernel (it should be in

		 /usr/src/linux/arch/i386/boot/zImage

if you did "make zImage") to something like

	      /boot/vmlinuz-2.0.0-JS-24Aug1996-firstTry

(long names are allowed, and useful if you are moving stuff into and
out of modules, or trying different author's drivers for the same
device, or whatever), make sure you've got a delay in your lilo.conf
so you can use &lt;LEFT SHIFT&gt; to bring up the boot menu, and add a copy
of your current Slackware boot stanza, then edit it to reflect the new
kernel (here's the relevant parts of mine):

# LILO configuration file
# by SJT 96/04/09
#
# LILO global stanza
delay = 50	# This gives you some time to call up the kernel menu
# leave the rest of the global stanza alone
vga = normal    # force sane state
ramdisk = 0     # paranoia setting
# 1st Linux stanza (untouched)
image = /boot/linux-1.2.13-95Sep14
  root = /dev/sda6
  label = linux1213
# 2nd Linux stanza (added by coping and editing first stanza)
image = /boot/vmlinuz-2.0.0	# edited to change kernel name
  root = /dev/sda6		# not edited
  label = linux200		# edited to give unique label
# DOS stanza (untouched)
other = /dev/sda1
  label = dos
  table = /dev/sda
# end of lilo.conf

and then run /sbin/lilo (as root, of course) when you've finished
editing it.  No big deal, but
(0) of course you have a boot disk, don't you, and you know how to
    boot to your normal system using it (you can use your Slackware
    boot disk with the "kernel root=/dev/sda1" option, substitute the
    correct kernel label and root device as in the lilo.conf)
(1) do a "cp /etc/lilo.conf /etc/lilo.conf.old" first; then you
    can recover from any lilo errors by copying back and running
    /sbin/lilo.
(2) leave the old kernel where it is and don't touch the related
    lilo.conf stanza
(3) leave the old kernel first, so that you can reboot to a stable
    environment without having to remember to select the old kernel
(4) if lilo exits with errors you should fix them (either fix the typo 
    if you understand the problem, or copy the old working lilo.conf
    back and run /sbin/lilo before doing anything else.

You can also do this operation from the Slackware setup menu if that
makes you more comfortable.

-- 
                           Stephen John Turnbull
University of Tsukuba                                        Yaseppochi-Gumi
Institute of Policy and Planning Sciences  <A TARGET="_top" HREF="http://turnbull.sk.tsukuba.ac.jp/">http://turnbull.sk.tsukuba.ac.jp/</A>
Tennodai 1-1-1, Tsukuba, 305 JAPAN                 turnbull@example.com
-----------------------------------------------------------------
a word from the sponsor will appear below
-----------------------------------------------------------------
The TLUG mailing list is proudly sponsored by TWICS - Japan's First
Public-Access Internet System.  Now offering 20,000 yen/year flat
rate Internet access with no time charges.  Full line of corporate
Internet and intranet products are available.   info@example.com
Tel: 03-3351-5977   Fax: 03-3353-6096

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00075" HREF="msg00075.html">Building a 2.0 kernel</A></STRONG>
<UL><LI><EM>From:</EM> schweiz@example.com (Jim Schweizer)</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00075.html">Building a 2.0 kernel</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00077.html">Re: Zaurus</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00075.html">Building a 2.0 kernel</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00078.html">Re: Building a 2.0 kernel</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="maillist.html#00076"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00076"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
