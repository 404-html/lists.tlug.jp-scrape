<!-- MHonArc v2.2.0 -->
<!--X-Subject: Re: tlug: [sendmail&#45;security@example.com: Sendmail Workaround for Linux Capabilities Bug] -->
<!--X-From: "Thomas O'Dowd" <tom@example.com> -->
<!--X-Date:  Fri, 9 Jun 2000 13:10:12 +0900 -->
<!--X-Message-Id: 20000609125846.H766@example.com -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 20000608155930.D18580@example.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-type" content="text/html">
  <meta name="Author" content="Jim Schweizer - webmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<!--X-Body-Begin-->
<!--X-User-Header-->
<P>
<font color="blue">
Support open source code!
</font>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00154.html">Date Prev</A>][<A HREF="msg00156.html">Date Next</A>][<A HREF="msg00151.html">Thread Prev</A>][<A HREF="msg00156.html">Thread Next</A>][<A HREF="maillist.html#00155">Date Index</A>][<A HREF="threads.html#00155">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong><A HREF="mailto:tlug@example.com">tlug@example.com</A></strong></LI>
<LI><strong>Subject</strong>: <strong>Re: tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</strong></LI>
<LI><strong>From</strong>: <strong>"Thomas O'Dowd" &lt;<A HREF="mailto:tom@example.com">tom@example.com</A>&gt;</strong></LI>
<LI>Date: Fri, 9 Jun 2000 12:58:46 +0900</LI>
<LI>Content-Type: text/plain; charset=us-ascii</LI>
<LI>In-Reply-To: &lt;<A HREF="msg00151.html">20000608155930.D18580@example.com</A>&gt;; from j-byrne@example.com on Thu, Jun 08, 2000 at 03:59:30PM +0900</LI>
<LI>References: &lt;<A HREF="msg00151.html">20000608155930.D18580@example.com</A>&gt;</LI>
<LI>Reply-To: <A HREF="mailto:tlug@example.com">tlug@example.com</A></LI>
<LI>Sender: owner-tlug</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
What's the lists feelings on qmail? When I used to have a REAL job, we
used sendmail but now that I've got my own machines setup at home, I 
don't use anything other than qmail. It was so easy to setup and the
security of it is very attractive. I haven't seen any problems reported.
sendmails config file is just way to hacky, but then again, that probably
appeals to most of you sick people :-)

Tom.

On Thu, Jun 08, 2000 at 03:59:30PM +0900, Jonathan Byrne wrote:
&gt; One we might all want to take a look at.
&gt; 
&gt; Jonathan
&gt; 
&gt; 
&gt; 
&gt; ----- Forwarded message from Sendmail Security &lt;sendmail-security@example.com&gt; -----
&gt; &gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; &gt; 
&gt; &gt; 		SENDMAIL SECURITY TEAM ADVISORY
&gt; &gt; 
&gt; &gt; 	Sendmail Workaround for Linux Capabilities Bug
&gt; &gt; 
&gt; &gt; The Sendmail Consortium and Sendmail, Inc. has been informed of a
&gt; &gt; serious problem in the Linux kernel that can be used to get root
&gt; &gt; access.  This is not a sendmail security problem, although sendmail
&gt; &gt; is one of the vectors for this attack.
&gt; &gt; 
&gt; &gt; PROBLEM
&gt; &gt; 
&gt; &gt; 	There is a bug in the Linux kernel capability model for versions
&gt; &gt; 	through 2.2.15 that allows local users to get root.  Sendmail is
&gt; &gt; 	one of the programs that can be attacked this way.  This problem
&gt; &gt; 	may occur in other capabilities-based kernels.
&gt; &gt; 
&gt; &gt; SOLUTION
&gt; &gt; 
&gt; &gt; 	The correct fix is to update your Linux kernel to version
&gt; &gt; 	2.2.16.  This is the only way to ensure that other programs
&gt; &gt; 	running on Linux cannot be attacked by this bug.
&gt; &gt; 
&gt; &gt; WORKAROUND
&gt; &gt; 
&gt; &gt; 	Sendmail 8.10.2 has added a check to see if the kernel has
&gt; &gt; 	this bug, and if so will refuse to run.  This version also
&gt; &gt; 	does more detailed checks on certain system calls, notably
&gt; &gt; 	setuid(2), to detect other possible attacks.  Although there
&gt; &gt; 	are no known attacks, this version is strongly recommended,
&gt; &gt; 	whether or not you have a vulnerable kernel.
&gt; &gt; 
&gt; &gt; 	Sendmail 8.10.2 can be obtained from:
&gt; &gt; 
&gt; &gt; 	<A TARGET="_top" HREF="ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.gz">ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.gz</A>
&gt; &gt; 	<A TARGET="_top" HREF="ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.Z">ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.Z</A>
&gt; &gt; 	<A TARGET="_top" HREF="ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.sig">ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.sig</A>
&gt; &gt; 
&gt; &gt;         and has MD5 signatures:
&gt; &gt; 
&gt; &gt; 	acb8b6f50869a058a9baaa4fb4692c4b sendmail.8.10.2.tar.Z
&gt; &gt; 	00705e5ca3412604cebd052e0d7aefcd sendmail.8.10.2.tar.gz
&gt; &gt; 	92dca37fb68a2a44f02c292656c123b6 sendmail.8.10.2.tar.sig
&gt; &gt; 
&gt; &gt; 	You only need one of the first two files (either the gzip'ed
&gt; &gt; 	version or the compressed version).  The .sig file is a PGP
&gt; &gt; 	signatures of the tar file (after uncompressing it).  It is
&gt; &gt; 	signed with the Sendmail Signing Key/2000, available on the web
&gt; &gt; 	site (<A TARGET="_top" HREF="http://www.sendmail.org/">http://www.sendmail.org/</A>) or on the public key servers.
&gt; &gt; 
&gt; &gt; 	Note however that installing this sendmail patch does not
&gt; &gt; 	fully protect you from attack.  Other programs are probably
&gt; &gt; 	vulnerable.
&gt; &gt; 
&gt; &gt; ACKNOWLEDGEMENTS
&gt; &gt; 
&gt; &gt; 	Several people contributed to this advisory.  Wojciech Purczynski
&gt; &gt; 	of Elzab Soft first identified the problem.  Alan Cox verified
&gt; &gt; 	and patched the Linux kernel bug.  Gregory Neil Shapiro and other
&gt; &gt; 	members of the Sendmail Consortium helped identify the problem
&gt; &gt; 	and produce the sendmail workaround.
&gt; &gt; 
&gt; &gt; DETAILS OF THE VULNERABILITY
&gt; &gt; 
&gt; &gt; 	The problem lies in the setcap(2) call, which is not documented
&gt; &gt; 	on most Linux-based systems (we think there might be a man page
&gt; &gt; 	on Mandrake).  This call, based on the unratified Posix 1e draft,
&gt; &gt; 	attempts to break down root permissions into a series of
&gt; &gt; 	capabilities.  Normally root has all capabilities and normal
&gt; &gt; 	users have none of the capabilities.
&gt; &gt; 
&gt; &gt; 	One such capability is the ability of a process to do an
&gt; &gt; 	arbitrary setuid(2) call.  As documented in ISO/IEC 9945-1
&gt; &gt; 	(ANSI/IEEE Std 1003.1) POSIX Part 1:
&gt; &gt; 
&gt; &gt; 		4.2.2.2 Description
&gt; &gt; 		...
&gt; &gt; 		   If {_POSIX_SAVED_IDS} is defined:
&gt; &gt; 
&gt; &gt; 		   (1) If the process has appropriate privileges, the
&gt; &gt; 		       setuid() function sets the real user ID, effective
&gt; &gt; 		       user ID, and the saved set-user-ID to uid.
&gt; &gt; 
&gt; &gt; 		   (2) If the process does not have the appropriate
&gt; &gt; 		       privileges, but uid is equal to the real user ID
&gt; &gt; 		       or the saved set-user-ID, the setuid() function
&gt; &gt; 		       sets the effective user ID to uid; the real user
&gt; &gt; 		       ID and saved set-user-ID remain unchanged by this
&gt; &gt; 		       function call.
&gt; &gt; 
&gt; &gt; 	The CAP_SETUID capability represents the "appropriate privileges".
&gt; &gt; 
&gt; &gt; 	Normally this would not be an issue, since a setuid root program
&gt; &gt; 	would simply have capability reinstated.  However, Linux has
&gt; &gt; 	an added capability CAP_SETPCAP that controls the ability of a
&gt; &gt; 	process to inherit capabilities; this capability does affect
&gt; &gt; 	setuid programs.  It is possible to set the capabilities such
&gt; &gt; 	that a setuid program does not have "appropriate privileges."
&gt; &gt; 	The effect of this is that a root program cannot fully give up
&gt; &gt; 	its root privileges (since the saved set-user-ID cannot be
&gt; &gt; 	reset).
&gt; &gt; 
&gt; &gt; 	Note that checking the return value from setuid() is insufficient;
&gt; &gt; 	the setuid(getuid()) succeeds even when the process does not have
&gt; &gt; 	"appropriate privileges."
&gt; &gt; 
&gt; &gt; 	The sendmail patch attempts a setuid(0) after a setuid(getuid());
&gt; &gt; 	under normal circumstances this should fail (unless of course
&gt; &gt; 	the real uid is root).  If this setuid(0) succeeds, then the
&gt; &gt; 	kernel has failed to properly give up permissions and sendmail
&gt; &gt; 	will refuse to continue running.
&gt; &gt; 
&gt; &gt; 	This problem can, of course, appear in any setuid root program
&gt; &gt; 	that attempts to cede special permissions.
&gt; &gt; 
&gt; &gt; -----BEGIN PGP SIGNATURE-----
&gt; &gt; Version: PGPfreeware 5.0 for non-commercial use
&gt; &gt; Charset: noconv
&gt; &gt; 
&gt; &gt; iQCVAwUBOT73YsApykAW9MzpAQExvgP+MjRKFw8IGCmzIdODUF6mIQ18/TETHtHb
&gt; &gt; AE7qUZs+0NBYhceF7Qn+UggKF53bBBc1gqvBmyqkJ8MFgEWNcx2cQawTxDU2G9wi
&gt; &gt; 7H95ffC9KxsVcO9CNU/1EmezLzJbQxAdgNNheHQ3MYVIBY32Bfdd3bO3oJ4uyXGd
&gt; &gt; 8UqMMIAkB3U=
&gt; &gt; =E2ZI
&gt; &gt; -----END PGP SIGNATURE-----
&gt; &gt; 
&gt; ----- End forwarded message -----
&gt; 
&gt; 
&gt; -----------------------------------------------------------------------
&gt; Next Meeting (w/ YLUG): June 16 (Fri) 19:00 Mizonoguchi Marui Family 12F
&gt; Next Technical Meeting: July 8 (Sat)  13:30 Topic: TBA
&gt; -----------------------------------------------------------------------
&gt; more info: <A TARGET="_top" HREF="http://www.tlug.gr.jp">http://www.tlug.gr.jp</A>        Sponsor: Global Online Japan

-- 
Thomas O'Dowd
tom@example.com
-----------------------------------------------------------------------
Next Meeting (w/ YLUG): June 16 (Fri) 19:00 Mizonoguchi Marui Family 12F
Next Technical Meeting: July 8 (Sat)  13:30 Topic: TBA
-----------------------------------------------------------------------
more info: <A TARGET="_top" HREF="http://www.tlug.gr.jp">http://www.tlug.gr.jp</A>        Sponsor: Global Online Japan

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00156" HREF="msg00156.html">Re: tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</A></STRONG>
<UL><LI><EM>From:</EM> Chris Sekiya &lt;sekiya@example.com&gt;</LI></UL></LI>
<LI><STRONG><A NAME="00160" HREF="msg00160.html">Re: tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</A></STRONG>
<UL><LI><EM>From:</EM> "Oliver M . Bolzer" &lt;oliver@example.com&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00151" HREF="msg00151.html">tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</A></STRONG>
<UL><LI><EM>From:</EM> Jonathan Byrne &lt;j-byrne@example.com&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00154.html">Re: tlug: Plan 9 open-sourced</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00156.html">Re: tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00151.html">tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00156.html">Re: tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="maillist.html#00155"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00155"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
