<!-- MHonArc v2.2.0 -->
<!--X-Subject: tlug: [sendmail&#45;security@example.com: Sendmail Workaround for Linux Capabilities Bug] -->
<!--X-From: Jonathan Byrne <j&#45;byrne@example.com> -->
<!--X-Date:  Thu, 8 Jun 2000 15:55:34 +0900 -->
<!--X-Message-Id: 20000608155930.D18580@example.com -->
<!--X-ContentType: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-type" content="text/html">
  <meta name="Author" content="Jim Schweizer - webmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<!--X-Body-Begin-->
<!--X-User-Header-->
<P>
<font color="blue">
Support open source code!
</font>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00150.html">Date Prev</A>][<A HREF="msg00152.html">Date Next</A>][<A HREF="msg00154.html">Thread Prev</A>][<A HREF="msg00155.html">Thread Next</A>][<A HREF="maillist.html#00151">Date Index</A>][<A HREF="threads.html#00151">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong>Tokyo Linux Users Group &lt;<A HREF="mailto:tlug@example.com">tlug@example.com</A>&gt;</strong></LI>
<LI><strong>Subject</strong>: <strong>tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</strong></LI>
<LI><strong>From</strong>: <strong>Jonathan Byrne &lt;<A HREF="mailto:j-byrne@example.com">j-byrne@example.com</A>&gt;</strong></LI>
<LI>Date: Thu, 8 Jun 2000 15:59:30 +0900</LI>
<LI>Content-Transfer-Encoding: 7bit</LI>
<LI>Content-Type: text/plain; charset=us-ascii</LI>
<LI>Reply-To: <A HREF="mailto:tlug@example.com">tlug@example.com</A></LI>
<LI>Sender: owner-tlug</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
One we might all want to take a look at.

Jonathan



----- Forwarded message from Sendmail Security &lt;sendmail-security@example.com&gt; -----
&gt; -----BEGIN PGP SIGNED MESSAGE-----
&gt; 
&gt; 		SENDMAIL SECURITY TEAM ADVISORY
&gt; 
&gt; 	Sendmail Workaround for Linux Capabilities Bug
&gt; 
&gt; The Sendmail Consortium and Sendmail, Inc. has been informed of a
&gt; serious problem in the Linux kernel that can be used to get root
&gt; access.  This is not a sendmail security problem, although sendmail
&gt; is one of the vectors for this attack.
&gt; 
&gt; PROBLEM
&gt; 
&gt; 	There is a bug in the Linux kernel capability model for versions
&gt; 	through 2.2.15 that allows local users to get root.  Sendmail is
&gt; 	one of the programs that can be attacked this way.  This problem
&gt; 	may occur in other capabilities-based kernels.
&gt; 
&gt; SOLUTION
&gt; 
&gt; 	The correct fix is to update your Linux kernel to version
&gt; 	2.2.16.  This is the only way to ensure that other programs
&gt; 	running on Linux cannot be attacked by this bug.
&gt; 
&gt; WORKAROUND
&gt; 
&gt; 	Sendmail 8.10.2 has added a check to see if the kernel has
&gt; 	this bug, and if so will refuse to run.  This version also
&gt; 	does more detailed checks on certain system calls, notably
&gt; 	setuid(2), to detect other possible attacks.  Although there
&gt; 	are no known attacks, this version is strongly recommended,
&gt; 	whether or not you have a vulnerable kernel.
&gt; 
&gt; 	Sendmail 8.10.2 can be obtained from:
&gt; 
&gt; 	<A TARGET="_top" HREF="ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.gz">ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.gz</A>
&gt; 	<A TARGET="_top" HREF="ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.Z">ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.Z</A>
&gt; 	<A TARGET="_top" HREF="ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.sig">ftp://ftp.sendmail.org/pub/sendmail/sendmail.8.10.2.tar.sig</A>
&gt; 
&gt;         and has MD5 signatures:
&gt; 
&gt; 	acb8b6f50869a058a9baaa4fb4692c4b sendmail.8.10.2.tar.Z
&gt; 	00705e5ca3412604cebd052e0d7aefcd sendmail.8.10.2.tar.gz
&gt; 	92dca37fb68a2a44f02c292656c123b6 sendmail.8.10.2.tar.sig
&gt; 
&gt; 	You only need one of the first two files (either the gzip'ed
&gt; 	version or the compressed version).  The .sig file is a PGP
&gt; 	signatures of the tar file (after uncompressing it).  It is
&gt; 	signed with the Sendmail Signing Key/2000, available on the web
&gt; 	site (<A TARGET="_top" HREF="http://www.sendmail.org/">http://www.sendmail.org/</A>) or on the public key servers.
&gt; 
&gt; 	Note however that installing this sendmail patch does not
&gt; 	fully protect you from attack.  Other programs are probably
&gt; 	vulnerable.
&gt; 
&gt; ACKNOWLEDGEMENTS
&gt; 
&gt; 	Several people contributed to this advisory.  Wojciech Purczynski
&gt; 	of Elzab Soft first identified the problem.  Alan Cox verified
&gt; 	and patched the Linux kernel bug.  Gregory Neil Shapiro and other
&gt; 	members of the Sendmail Consortium helped identify the problem
&gt; 	and produce the sendmail workaround.
&gt; 
&gt; DETAILS OF THE VULNERABILITY
&gt; 
&gt; 	The problem lies in the setcap(2) call, which is not documented
&gt; 	on most Linux-based systems (we think there might be a man page
&gt; 	on Mandrake).  This call, based on the unratified Posix 1e draft,
&gt; 	attempts to break down root permissions into a series of
&gt; 	capabilities.  Normally root has all capabilities and normal
&gt; 	users have none of the capabilities.
&gt; 
&gt; 	One such capability is the ability of a process to do an
&gt; 	arbitrary setuid(2) call.  As documented in ISO/IEC 9945-1
&gt; 	(ANSI/IEEE Std 1003.1) POSIX Part 1:
&gt; 
&gt; 		4.2.2.2 Description
&gt; 		...
&gt; 		   If {_POSIX_SAVED_IDS} is defined:
&gt; 
&gt; 		   (1) If the process has appropriate privileges, the
&gt; 		       setuid() function sets the real user ID, effective
&gt; 		       user ID, and the saved set-user-ID to uid.
&gt; 
&gt; 		   (2) If the process does not have the appropriate
&gt; 		       privileges, but uid is equal to the real user ID
&gt; 		       or the saved set-user-ID, the setuid() function
&gt; 		       sets the effective user ID to uid; the real user
&gt; 		       ID and saved set-user-ID remain unchanged by this
&gt; 		       function call.
&gt; 
&gt; 	The CAP_SETUID capability represents the "appropriate privileges".
&gt; 
&gt; 	Normally this would not be an issue, since a setuid root program
&gt; 	would simply have capability reinstated.  However, Linux has
&gt; 	an added capability CAP_SETPCAP that controls the ability of a
&gt; 	process to inherit capabilities; this capability does affect
&gt; 	setuid programs.  It is possible to set the capabilities such
&gt; 	that a setuid program does not have "appropriate privileges."
&gt; 	The effect of this is that a root program cannot fully give up
&gt; 	its root privileges (since the saved set-user-ID cannot be
&gt; 	reset).
&gt; 
&gt; 	Note that checking the return value from setuid() is insufficient;
&gt; 	the setuid(getuid()) succeeds even when the process does not have
&gt; 	"appropriate privileges."
&gt; 
&gt; 	The sendmail patch attempts a setuid(0) after a setuid(getuid());
&gt; 	under normal circumstances this should fail (unless of course
&gt; 	the real uid is root).  If this setuid(0) succeeds, then the
&gt; 	kernel has failed to properly give up permissions and sendmail
&gt; 	will refuse to continue running.
&gt; 
&gt; 	This problem can, of course, appear in any setuid root program
&gt; 	that attempts to cede special permissions.
&gt; 
&gt; -----BEGIN PGP SIGNATURE-----
&gt; Version: PGPfreeware 5.0 for non-commercial use
&gt; Charset: noconv
&gt; 
&gt; iQCVAwUBOT73YsApykAW9MzpAQExvgP+MjRKFw8IGCmzIdODUF6mIQ18/TETHtHb
&gt; AE7qUZs+0NBYhceF7Qn+UggKF53bBBc1gqvBmyqkJ8MFgEWNcx2cQawTxDU2G9wi
&gt; 7H95ffC9KxsVcO9CNU/1EmezLzJbQxAdgNNheHQ3MYVIBY32Bfdd3bO3oJ4uyXGd
&gt; 8UqMMIAkB3U=
&gt; =E2ZI
&gt; -----END PGP SIGNATURE-----
&gt; 
----- End forwarded message -----


-----------------------------------------------------------------------
Next Meeting (w/ YLUG): June 16 (Fri) 19:00 Mizonoguchi Marui Family 12F
Next Technical Meeting: July 8 (Sat)  13:30 Topic: TBA
-----------------------------------------------------------------------
more info: <A TARGET="_top" HREF="http://www.tlug.gr.jp">http://www.tlug.gr.jp</A>        Sponsor: Global Online Japan

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00155" HREF="msg00155.html">Re: tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</A></STRONG>
<UL><LI><EM>From:</EM> "Thomas O'Dowd" &lt;tom@example.com&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00150.html">Re: tlug: META tags in perl scripts</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00152.html">Re: tlug: Python GUI toolkits</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00154.html">Re: tlug: Plan 9 open-sourced</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00155.html">Re: tlug: [sendmail-security@example.com: Sendmail Workaround for Linux Capabilities Bug]</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="maillist.html#00151"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00151"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
