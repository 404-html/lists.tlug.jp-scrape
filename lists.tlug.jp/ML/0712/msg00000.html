<!-- MHonArc v2.6.10 -->
<!--X-Subject: [tlug] Mencoder conversion of files -->
<!--X-From-R13: Rnir [ U <qnirNnegvpynff.bet> -->
<!--X-Date: Sat, 01 Dec 2007 00:23:23 +0900 -->
<!--X-Message-Id: 47502636.3060005@articlass.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="Author" content="Jim Tittsler - listmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<P>
<TABLE BGCOLOR="#FFFF66" BORDER=1 COLS=1 WIDTH="90%" CLASS=navbar>
<TR>
<TD>&nbsp;&nbsp;
<FONT FACE="Verdana, Lucida Sans, Arial, Helvetica, Geneva, sans-serif"><SMALL>
<A HREF="../../index.html" TITLE="Tokyo Linux Users Group Page">
<STRONG>tlug.jp</STRONG></A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../../list.html" TITLE="Mailing List Page">Mailing List</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../index.html" TITLE="tlug Archive Page">tlug archive</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
tlug Mailing List Archive
</SMALL></FONT>
</TD></TR>
</TABLE>
<P>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[Date Prev][<a href="msg00001.html">Date Next</a>][Thread Prev][<a href="msg00001.html">Thread Next</a>][<a href="maillist.html#00000">Date Index</a>][<a href="threads.html#00000">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[tlug] Mencoder conversion of files</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li>Date: Sat, 01 Dec 2007 00:03:18 +0900</li>
<li><strong>From</strong>: <strong>Dave M G &lt;<a href="mailto:dave@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Mencoder%20conversion%20of%20files">dave@example.com</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>[tlug] Mencoder conversion of files</strong></li>
<li>User-agent: Thunderbird 2.0.0.6 (X11/20071022)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre style="margin: 0em;">TLUG,</pre><br>
<tt>I'm posting this here mainly because I can't find a really decent Linux 
oriented video editing forum. I mean, there's discussion on about video 
editing on Linux forums, and discussion of Linux on video editing 
forums, but there doesn't seem to be any one community that's really 
dedicated to Linux based, or open source, video editing.</tt><br>
<br>
<pre style="margin: 0em;">If anyone knows of a good one, let me know where I might post my issue here.</pre><br>
<pre style="margin: 0em;">In the meantime, here's the situation I'm looking for help on.</pre><br>
<pre style="margin: 0em;">The Set Up:</pre><br>
<tt>I'm running Ubuntu Gutsy, 7.10, and I've got mencoder, ffmpeg, and have 
installed every codec I can think of (Specifics listed below).</tt><br>
<br>
<tt>I have a Sony HD video camera which writes everything in an uncompressed 
MPEG format. The camera connects by USB and behaves like an external 
hard disk - no need for DV capture utilities, just simple file 
transfers. The frame rate of the files is 30fps, and the size can be 
either 720X480, or 640X480.</tt><br>
<br>
<tt>The video camera splits video at the 2 GB mark. I'm not sure of the 
exact megabyte to time ratio, but usually a 40 minute to an hour 
recording will result in two files, the first being exactly 2 GB, and 
the second a little over 1 GB.</tt><br>
<br>
<pre style="margin: 0em;">The Goals:</pre><br>
<tt>What I want to do is store these recordings in a smaller more manageable 
 format, like AVI (DivX? Suggestions welcome).</tt><br>
<br>
<tt>Ideally, what I'd like to do is:<br>
1. Append the files together. They are always numbered like so:<br>
m2u00066.mpg, m2u00067.mpg, m2u00068.mpg. So, assuming that I want to 
merge all videos in a directory, append them in order of file number.<br>
2. De-interlace.<br>
3. Save in a reasonably high quality but smaller format, like an AVI. I 
understand that smaller file format equals some quality loss, but I 
don't need to preserve original quality, I just need a result that is clear.</tt><br>
<br>
<tt>What I've Done:<br>
I found this script, mpg2avi, which uses mencoder to make the 
conversion. The results are an avi file of acceptable quality.<br>
<a  href="http://www.linuxquestions.org/linux/answers/Applications_GUI_Multimedia/Batch_convert_MPEG_files_to_AVI_0">http://www.linuxquestions.org/linux/answers/Applications_GUI_Multimedia/Batch_convert_MPEG_files_to_AVI_0</a></tt><br>
<br>
<tt>The problems:<br>
1. Despite having lame installed, it keeps giving an audio codec not 
found error (reproduced below).<br>
2. Does not seem to handle the 720X480 size.<br>
3. I don't think it deinterlaces the video.<br>
4. Has no option to append videos together.</tt><br>
<br>
<tt>The question:<br>
Can these errors be resolved, and then the de-interlacing and appending 
functions added?</tt><br>
<br>
<pre style="margin: 0em;">Thank you for any advice.</pre><br>
<pre style="margin: 0em;">- - - - -</pre><br>
<pre style="margin: 0em;">Here are the errors I am seeing:</pre><br>
<pre style="margin: 0em;">MEncoder 2:1.0~rc2-0ubuntu1~gutsy1 (C) 2000-2007 MPlayer Team
CPU: Intel(R) Pentium(R) D CPU 2.80GHz (Family: 15, Model: 6, Stepping: 2)
CPUflags: Type: 15 MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 1
Compiled with runtime CPU detection.
success: format: 0  data: 0x0 - 0x7dc70000
MPEG-PS file format detected.
VIDEO:  MPEG2  720x480  (aspect 3)  29.970 fps  9100.0 kbps (1137.5 kbyte/s)
[V] filefmt:2  fourcc:0x10000002  size:720x480  fps:29.97  ftime:=0.0334
==========================================================================
Opening audio decoder: [liba52] AC3 decoding with liba52
Using SSE optimized IMDCT transform
Using MMX optimized resampler
AUDIO: 48000 Hz, 2 ch, s16le, 448.0 kbit/29.17% (ratio: 56000-&gt;192000)
Selected audio codec: [a52] afm: liba52 (AC3-liba52)
==========================================================================
Opening video filter: [expand osd=1]
Expand: -1 x -1, -1 ; -1, osd: 1, aspect: 0.000000, round: 1
Opening video filter: [scale w=740 h=480]
==========================================================================
Opening video decoder: [mpegpes] MPEG 1/2 Video passthrough
VDec: vo config request - 720 x 480 (preferred colorspace: Mpeg PES)
The selected video_out device is incompatible with this codec.
Try appending the scale filter to your filter list,
e.g. -vf spp,scale instead of -vf spp.
VDecoder init failed :(
Opening video decoder: [libmpeg2] MPEG 1/2 Video decoder libmpeg2-v0.4.0b
Selected video codec: [mpeg12] vfm: libmpeg2 (MPEG-1 or 2 (libmpeg2))
==========================================================================
Audio LAVC, couldn't find encoder for codec mp3.</pre><br>
<pre style="margin: 0em;"><br>- - - - -</pre><br>
<pre style="margin: 0em;">Here are the contents of the script:</pre><br>
<pre style="margin: 0em;">#!/bin/bash</pre><br>
<pre style="margin: 0em;">#mpg2avi (Convert mpeg streams into high quality mpeg4 avi with mp3 audio)</pre><br>
<pre style="margin: 0em;">#requirements: mplayer</pre><br>
<pre style="margin: 0em;">#Begin
clear</pre><br>
<pre style="margin: 0em;"># variables
version=0.2b</pre><br>
<pre style="margin: 0em;">current_directory=$( pwd )
# video bitrate (1100 = around 500 MB movie size)
vbitrate=1100</pre><br>
<pre style="margin: 0em;">echo -e &quot;* mpg2avi v${version}&quot;</pre><br>
<tt># remove spaces<br>
for i in *.[Mm][Pp][Gg]; do mv &quot;$i&quot; `echo $i | tr ' ' '_'`; done &gt; 
/dev/null 2&gt;&amp;1 &amp;</tt><br>
<br>
<tt># remove uppercase<br>
for i in *.[Mm][Pp][Gg]; do mv &quot;$i&quot; `echo $i | tr '[A-Z]' '[a-z]'`; done 
&gt; /dev/null 2&gt;&amp;1 &amp;</tt><br>
<br>
<tt># convert mpg movies into avi's with mencoder<br>
for i in *.[Mm][Pp][Gg]; do nice -n 10 mencoder $i -ovc lavc -lavcopts 
vcodec=mpeg4:vbitrate=$vbitrate:vhq:vqmin=2:vlelim=-4:vcelim=9:lumi_mask=0.05:dark_mask=0.01 
-vf pp=md  -vf scale=720:480, -oac lavc -lavcopts 
acodec=mp3:abitrate=128 -o &quot;`basename &quot;$i&quot;`.avi&quot;;echo &quot;Conversion done&quot;;done</tt><br>
<br>
<pre style="margin: 0em;">exit;</pre><br>
<pre style="margin: 0em;">- - - - -</pre><br>
<pre style="margin: 0em;">And here is some additional informational output:</pre><br>
<pre style="margin: 0em;"><br></pre><br>
<pre style="margin: 0em;">dave@example.com:~$ mencoder -ovc help
MEncoder 2:1.0~rc2-0ubuntu1~gutsy1 (C) 2000-2007 MPlayer Team
CPU: Intel(R) Pentium(R) D CPU 2.80GHz (Family: 15, Model: 6, Stepping: 2)
CPUflags: Type: 15 MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 1
Compiled with runtime CPU detection.</pre><br>
<tt>Available codecs:<br>
   copy     - frame copy, without re-encoding. Doesn't work with filters.<br>
   frameno  - special audio-only file for 3-pass encoding, see DOCS.<br>
   raw      - uncompressed video. Use fourcc option to set format 
explicitly.<br>
   nuv      - nuppel video<br>
   lavc     - libavcodec codecs - best quality!<br>
   vfw      - VfW DLLs, read DOCS/HTML/en/encoding-guide.html.<br>
   qtvideo  - QuickTime DLLs, currently only SVQ1/3 are supported.<br>
   libdv    - DV encoding with libdv v0.9.5<br>
   xvid     - XviD encoding<br>
   x264     - H.264 encoding</tt><br>
<br>
<pre style="margin: 0em;">dave@example.com:~$ mencoder -oac help
MEncoder 2:1.0~rc2-0ubuntu1~gutsy1 (C) 2000-2007 MPlayer Team
CPU: Intel(R) Pentium(R) D CPU 2.80GHz (Family: 15, Model: 6, Stepping: 2)
CPUflags: Type: 15 MMX: 1 MMX2: 1 3DNow: 0 3DNow2: 0 SSE: 1 SSE2: 1
Compiled with runtime CPU detection.</pre><br>
<pre style="margin: 0em;">Available codecs:
   copy     - frame copy, without re-encoding (useful for AC3)
   pcm      - uncompressed PCM audio
   mp3lame  - cbr/abr/vbr MP3 using libmp3lame
   lavc     - FFmpeg audio encoder (MP2, AC3, ...)
   twolame  - Twolame MP2 audio encoder
   faac     - FAAC AAC audio encoder</pre><br>
<pre style="margin: 0em;">--
Dave M G
Ubuntu 7.10</pre><br>
<pre style="margin: 0em;"><br></pre><br>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00001" href="msg00001.html">Re: [tlug] Mencoder conversion of files</a></strong>
<ul><li><em>From:</em> Attila Kinali</li></ul></li>
<li><strong><a name="00004" href="msg00004.html">Re: [tlug] Mencoder conversion of files</a></strong>
<ul><li><em>From:</em> Godwin Stewart</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Next by Date:
<strong><a href="msg00001.html">Re: [tlug] Mencoder conversion of files</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00001.html">Re: [tlug] Mencoder conversion of files</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00000"><strong>Date</strong></a></li>
<li><a href="threads.html#00000"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
