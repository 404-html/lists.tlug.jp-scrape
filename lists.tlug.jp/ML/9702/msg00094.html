<!-- MHonArc v2.2.0 -->
<!--X-Subject: Re: tlug: Mucked up my kterm fonts -->
<!--X-From: jwb@example.com (Jim Breen) -->
<!--X-Date:  Tue, 25 Feb 1997 22:57:29 GMT -->
<!--X-Message-Id: 199702252252.JAA08200@example.com -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: turnbull@example.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-type" content="text/html">
  <meta name="Author" content="Jim Schweizer - webmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<!--X-Body-Begin-->
<!--X-User-Header-->
<P>
<font color="blue">
Support open source code!
</font>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00093.html">Date Prev</A>][<A HREF="msg00095.html">Date Next</A>][<A HREF="msg00091.html">Thread Prev</A>][<A HREF="msg00102.html">Thread Next</A>][<A HREF="maillist.html#00094">Date Index</A>][<A HREF="threads.html#00094">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: tlug: Mucked up my kterm fonts</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong><A HREF="mailto:tlug@example.com">tlug@example.com</A></strong></LI>
<LI><strong>Subject</strong>: <strong>Re: tlug: Mucked up my kterm fonts</strong></LI>
<LI><strong>From</strong>: <strong><A HREF="mailto:jwb@example.com">jwb@example.com</A> (Jim Breen)</strong></LI>
<LI>Date: Wed, 26 Feb 1997 09:52:46 -0500</LI>
<LI>In-Reply-To: "Stephen J. Turnbull" &lt;turnbull@example.com&gt;      "Re: tlug: Mucked up my kterm fonts" (Feb 25,  6:23pm)</LI>
<LI>Reply-To: <A HREF="mailto:tlug@example.com">tlug@example.com</A></LI>
<LI>Sender: owner-tlug</LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
--------------------------------------------------------
tlug note from jwb@example.com (Jim Breen)
--------------------------------------------------------
On Feb 25,  6:23pm, "Stephen J. Turnbull" wrote:
} Subject: Re: tlug: Mucked up my kterm fonts

Well, my problem is fixed, not because of specific advice from anyone on
TLUG, but because Jason Molenda made a suggestion which, while it didn't
work, made me revisit the problem, fiddle a bit more, and hey-presto 
everything is working, including the 24x24 JIS212 fonts.

I'll  explain below what I actually did, but to turn to Stephen's mail:

&gt;&gt;     Jim&gt; This is a faint cry for help. I did something stupid, and I
&gt;&gt;     Jim&gt; don't know how to get out of it.
&gt;&gt; 
&gt;&gt; Easy enough to do in X Windows.  Easy enough to undo, usually, if you
&gt;&gt; know how, unlike Microsoft products.

8-)}

&gt;&gt; 
&gt;&gt;     Jim&gt; I was having trouble getting the new font to work, so I was
&gt;&gt;     Jim&gt; poking around with xfontsel. It displays the new font
&gt;&gt;     Jim&gt; perfectly, but there was no way I could get it to work with
&gt;&gt;     Jim&gt; kterm. Pity.
&gt;&gt; 
&gt;&gt; ?? This is strange.  I assume for xfontsel to work, you put the font
&gt;&gt; in a directory on your X font path, did "mkfontdir", and "xset fp
&gt;&gt; rehash".  Then you should be able to (if necessary) edit your
&gt;&gt; ~/.Xresources file and add "KTerm*VT100*...."  Ooops.  This is the
&gt;&gt; KTerm you hacked up yourself.  Did you do the right things with
&gt;&gt; putting the ability to select the JISX-0212 font in a resource and all
&gt;&gt; that?  If not, if you just hard-coded that stuff, then it's not going
&gt;&gt; to work....  You're going to have to rebuild KTerm-212 to use a
&gt;&gt; different font.

No, it's the X11R6 kterm with the patches (devised in Japan) to extend it
to extra fonts, including JIS X 0212. I only found  and fixed a bug which 
kept crashing it in jstevie (for some reason, I am the only person in the 
Known Universe with a penchant for using vi-like editors on JIS212 text.)

And yes, it has all the kosher app.defaults, etc. etc.

&gt;&gt; By the way, KTerm 6.2.0 advertises the ability to use JISX0212.1990-0
&gt;&gt; fonts....  I don't have such a font, so I haven't tried it yet.  I
&gt;&gt; guess I'll go fishing at ftp.monash....

I have the 16x16 bdf there.

&gt;&gt;     Jim&gt; Next day, to my horror, I found the grotesque fonts were
&gt;&gt;     Jim&gt; still there as my defaults.
&gt;&gt; 
&gt;&gt; Yipe!
&gt;&gt; 
&gt;&gt;     Jim&gt; I've done all the correct things like getting xfontsel to
&gt;&gt;     Jim&gt; select the (kosher) font, highlighting the _select_ box, and
&gt;&gt;     Jim&gt; selecting the "default" with Ctrl-Right_Button, but it never
&gt;&gt;     Jim&gt; works.
&gt;&gt; 
&gt;&gt; Try selecting "selection" in the Fonts menu?  

Did that.

&gt;&gt; The man page is not very
&gt;&gt; specific about this, nor is OReilly's Vol. 3 "X Window System User's
&gt;&gt; Guide."  If you don't have this book, the next best alternative is
&gt;&gt; reading the source code, with reading man pages a distant third.  Get
&gt;&gt; it!  But in this case it didn't help much.

We have the O'Reilly. It didn't really help.

&gt;&gt; As far as I can tell from the documentation, you can't directly change 
&gt;&gt; your defaults using xfontsel and the Fonts menu in X/KTerm.  Are you
&gt;&gt; sure that's what you did?  It seems to me that you must have edited
&gt;&gt; either your .Xresources or /usr/X11R6/lib/X11/app-defaults/KTerm.

I didn't touch either. Neither had the time/date changed. The latter was,
of course, reset when I originally did the "make install" for the kterm.
I suspect there is some other file in an obscure place known to the
server.

&gt;&gt;     Jim&gt; The matter has mystified our sysadmins here, who admit to
&gt;&gt;     Jim&gt; being not up on Xfont matters. We haven't been able to find
&gt;&gt;     Jim&gt; where all this scaling info is held.
&gt;&gt; 
&gt;&gt; The information is in the XLFD name (that monstrously long thing with
&gt;&gt; lots of hyphens and ending in a registered character set name).  A
&gt;&gt; scalable-by-design font has zeros in the fields labelled
&gt;&gt; "*-pxlsz-ptSz-resx-resy-*-avgWdth-*" in xfontsel.  In such a font the
&gt;&gt; resx and resy (design resolution) fields are dummies and should be set
&gt;&gt; to zero.  Setting any one of the others will generate a real font
&gt;&gt; internal to the server.  A font that is not scalable by design can be
&gt;&gt; rescaled by setting pxlsz and avgWdth to zero and specifying ptSz.
&gt;&gt; Again this generates a font internal to the server.

Correct. It was the details of the XLFD which you can fiddle with
interactively from xfontsel. My problem arose from that "font internal to
the server" being locked in as the default.

&gt;&gt; As far as I know, you have to edit the app-defaults file or the
&gt;&gt; .Xresources file (preferably the one that was changed), get rid of the 
&gt;&gt; offending scaled font, and put in a correct bitmap font.  You should
&gt;&gt; only need to copy the entry for "*VT100*fontList4" to
&gt;&gt; "*VT100*fontList" (be careful about backslash-newline combos at the
&gt;&gt; end of the line).  In any case doing this should fix things.
&gt;&gt; 
&gt;&gt; The other possibility is that I'm wrong about the font being internal
&gt;&gt; (this wouldn't surprise me given that kanji fonts are huge).  If a new
&gt;&gt; font has been written to a "cache file" *and* it matches an ambiguous
&gt;&gt; (or -- horrors! -- unambiguous) XLFD better than the "real" font, then
&gt;&gt; you're in TRUH-BULL and can only get out by deleting the server-
&gt;&gt; generated font.  You'll have to find it first....

Which I was never able to do! I'm pretty sure that the server rebuilt it
each time I started X, but I could never find from where. As I mentioned,
none of the resource files had been changed.

&gt;&gt; Do "xlsfonts -fn '-*-*-*-*-*-*-16-*-*-*-*-*-jisx0208.1983-*'" and send
&gt;&gt; me the output; I should be able to make a better guess with that info.

Well, being a purist, I use the 1990 sets (those last two jinmeiyoukanji
are *SO* important 8-)}

Anyway, it's fixed, and this is how it happened.

(a) Jason asked me if I still had the problem if I ran X as another user.
I tried this, and yes it still occurred. 

(b) I tried both the old JE kterm and the patched version, noticed that 
they pick up different  fonts, and looked (again) at the app.defaults. The
newer kterm has a general XLFD mask and has the older line-by-line font
details commented out. That got be wondering about the fact that I had
never been able get my 24x24 JIS212 font working.

(c) I (re)visited my font.dir file and found that the XLFD of the 24x24
JIS212 font didn't match the mask. 'mkfontdir' extracts this from the
header of the .bdf, and I hadn't previously twigged that a mask was
operating with the newer kterm.

(d) I edited the .bdf header to make the XLFD conform to what kterm wanted
("--misc-fixed-r- etc etc."), ran mkfontdir, restarted X and crossed my
fingers.

	The result:

	A. The 24x24 font now works correctly, so now I can select "Large"
	for text containing both JIS X 212 and JIS X 208 characters.

	B. somewhere along the line the bogus scalings of the 16x16 font
	fell off. It has reverted to the ones I wanted.

So, great sighs of relief, head-shaking at the mysteries of it all,
delight that can now use the 24x24 JIS212.

Thanks for the suggestions, Stephen. I had pretty well tried them all
already. Obviously resting the problem and making a fresh start helped.

BTW, I have mentioned a 24x24 bdf for JIS212. This is NOT publicly
available. A friend who shall be nameless, but who, er,  works in fonts
slipped me a copy for personal use. For all sorts of labyrinthine
commercial reasons his company cannot release bitmapped versions of this
font.

One reason I was keen to get the font is that I use (from both Linux and
Ultrix) the "jem2tex" printing method, which enable printing of Japanese
via ordinary non-Japanese LaTeX, TeX and postscript. The fonts used are
special MFs created from the 24x24 bitmapped fonts. I intend to hack into
the font generators to extend them to JIS212. (FWIW, at home I use an HP
inkjet, and print through gs. Works fine.)

Back to work..

Jim Breen
jwb@example.com

-----------------------------------------------------------------
a word from the sponsor will appear below
-----------------------------------------------------------------
The TLUG mailing list is proudly sponsored by TWICS - Japan's First
Public-Access Internet System.  Now offering 20,000 yen/year flat
rate Internet access with no time charges.  Full line of corporate
Internet and intranet products are available.   info@example.com
Tel: 03-3351-5977   Fax: 03-3353-6096

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00102" HREF="msg00102.html">Re: tlug: Mucked up my kterm fonts</A></STRONG>
<UL><LI><EM>From:</EM> "Stephen J. Turnbull" &lt;turnbull@example.com&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00093.html">tlug: X internationalized input (XIM and kinput2)</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00095.html">Re: tlug: Thashed to death</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00091.html">Re: tlug: Mucked up my kterm fonts</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00102.html">Re: tlug: Mucked up my kterm fonts</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="maillist.html#00094"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00094"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
