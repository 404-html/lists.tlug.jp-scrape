<!-- MHonArc v2.5.0 -->
<!--X-Subject: Re: kinput and kterm SOLVED!!!!! -->
<!--X-From-R13: [vxr Tnovna <zsnovnaNfhfr.qr> -->
<!--X-Date: 23 Oct 2001 10:40:57 +0200 -->
<!--X-Message-Id: s3titd64uli.fsf@example.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20011022064213.C19323@example.com -->
<!--X-Reference: s3telnw6in2.fsf@example.com -->
<!--X-Reference: 20011022134657.B20628@example.com -->
<!--X-Reference: 20011022141239.A1121@example.com -->
<!--X-Reference: 20011022144407.N19322@example.com -->
<!--X-Reference: s3tsncb6dci.fsf@example.com -->
<!--X-Reference: 20011023073330.O19322@example.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-type" content="text/html">
  <meta name="Author" content="TLUG webmaster">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<!--X-Body-Begin-->
<!--X-User-Header-->
<P>
<font color="blue">
Support open source code!
</font>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00033.html">Date Prev</a>][<a href="msg00035.html">Date Next</a>][<a href="msg00026.html">Thread Prev</a>][<a href="msg00036.html">Thread Next</a>][<a href="maillist.html#00034">Date Index</a>][<a href="threads.html#00034">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: kinput and kterm SOLVED!!!!!</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li><strong>To</strong>: <strong><A HREF="mailto:tlug@example.com">tlug@example.com</A></strong></li>
<li><strong>Subject</strong>: <strong>Re: kinput and kterm SOLVED!!!!!</strong></li>
<li><strong>From</strong>: <strong>Mike Fabian &lt;<A HREF="mailto:mfabian@example.com">mfabian@example.com</A>&gt;</strong></li>
<li>Date: 23 Oct 2001 10:40:57 +0200</li>
<li>Content-type: text/plain; charset=iso-2022-jp</li>
<li>Delivered-to: tlug@example.com</li>
<li>In-reply-to: Martin Baehr's message of &quot;Tue, 23 Oct 2001 07:33:31 +0200&quot;</li>
<li>List-help: &lt;<A HREF="mailto:tlug-request@example.comsubject=help">mailto:tlug-request@example.comsubject=help</A>&gt;</li>
<li>List-post: &lt;<A HREF="mailto:tlug@example.com">mailto:tlug@example.com</A>&gt;</li>
<li>List-subscribe: &lt;<A HREF="mailto:tlug-request@example.comsubject=subscribe">mailto:tlug-request@example.comsubject=subscribe</A>&gt;</li>
<li>List-unsubscribe: &lt;<A HREF="mailto:tlug-request@example.comsubject=unsubscribe">mailto:tlug-request@example.comsubject=unsubscribe</A>&gt;</li>
<li>Old-return-path: &lt;mfabian@example.com&gt;</li>
<li>References: &lt;<a href="msg00014.html">20011022064213.C19323@example.com</a>&gt;&lt;<a href="msg00018.html">s3telnw6in2.fsf@example.com</a>&gt;&lt;<a href="msg00021.html">20011022134657.B20628@example.com</a>&gt;&lt;<a href="msg00022.html">20011022141239.A1121@example.com</a>&gt;&lt;<a href="msg00023.html">20011022144407.N19322@example.com</a>&gt;&lt;<a href="msg00024.html">s3tsncb6dci.fsf@example.com</a>&gt;&lt;<a href="msg00026.html">20011023073330.O19322@example.com</a>&gt;</li>
<li>Reply-to: <A HREF="mailto:mfabian@example.com">mfabian@example.com</A></li>
<li>Resent-from: <A HREF="mailto:tlug@example.com">tlug@example.com</A></li>
<li>Resent-message-id: &lt;s1x3bB.A.Lr.QyS17@example.com&gt;</li>
<li>Resent-sender: <A HREF="mailto:tlug-request@example.com">tlug-request@example.com</A></li>
<li>Sender: <A HREF="mailto:mfabian@example.com">mfabian@example.com</A></li>
<li>User-agent: Gnus/5.0808 (Gnus v5.8.8) XEmacs/21.4 (Artificial Intelligence)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Martin Baehr &lt;mbaehr@example.com&gt; writes:

&gt; On Mon, Oct 22, 2001 at 02:58:21PM +0200, Mike Fabian wrote:
&gt; &gt; &gt; &gt; |en_US ISO-8859-1
&gt; &gt; &gt; &gt; |en_US.UTF-8 UTF-8
&gt; &gt; &gt; &gt; |ja_JP.EUC-JP EUC-JP
&gt; &gt; &gt; &gt; |ja_JP EUC-JP
&gt; &gt; &gt; &gt; |ja_JP.UTF-8 UTF-8
&gt; &gt; &gt; kinput still doesn't work, but the errormessage is gone,
&gt; &gt; You wrote in another mail:
&gt; &gt; MB&gt; $ Warning: locale not supported by C library, locale unchanged
&gt; &gt; MB&gt; Couldn't set locale: ja_JP.eucJP,ja_JP.ujis,ja_JP.EUC,japanese.euc,Japanese-EUC,ja,japan
&gt; &gt; None of the locales you did set in /etc/locale.gen is on the list of
&gt; &gt; locales which kterm tries. Put ja_JP.eucJP as well in /etc/locale.gen.
&gt; 
&gt; no, read again, adding the above locales DID fix the error.
&gt; 
&gt; and as it turned out, when i tried again at home also kinput DID work.

&gt; &gt; &gt; and kterms menues are now in japanese 
&gt; &gt; &gt; (not sure i want that, as i can't actually read it ;-)
&gt; &gt; Or, if you want to change it globally, you may remove the global
&gt; &gt; Japanese app-defaults file.
&gt; 
&gt; no need for any of that, as it turns out, all that is really necesary is
&gt; to set 
&gt; XMODIFIERS="@example.com=kinput2"
&gt; and i guess the generated locales as well.
&gt; (i don't know what to delete to test 
&gt; if having the locales makes a difference)
&gt; 
&gt; nothing else.
&gt; kinput happily works with all my locale stuff set to C,
&gt; allowing me to keep english menues without having to move stuff around.

kterm behaves quite weird with setlocale. Internally, it tries to set
all locales from the above list, no matter what locale you have set in
your environment. I.e. even if you have your locale set to C,
kterm ignores this and tries to set the locales from the above
list subsequently

    setlocale(LC_CTYPE,"ja_JP.eucJP")
    setlocale(LC_CTYPE,"ja_JP.ujis")
    setlocale(LC_CTYPE,"ja_JP.EUC")
    ...

and stops after the first sucessfull call to setlocale(). I.e, even if
you have you locale set to C, but you have a locale ja_JP.eucJP
available, kterm will use ja_JP.eucJP internally. This often forces
kterm to work correctly with Japanese even if you have set a
non-Japanese locale in your environment. But, depending on the version
of your libc, this sometimes seems to cause problems. You don't see
any error message because the kterm internal setlocale() call is
successfull, but something still doesn't work right. That was what I
suspected when you wrote:

&gt; ahh, i set these:
&gt; 
&gt; &gt; |en_US ISO-8859-1
&gt; &gt; |en_US.UTF-8 UTF-8
&gt; &gt; |ja_JP.EUC-JP EUC-JP
&gt; &gt; |ja_JP EUC-JP
&gt; &gt; |ja_JP.UTF-8 UTF-8
&gt; 
&gt; kinput still doesn't work, but the errormessage is gone,

I have observed exactly the behaviour you describe here with some
versions of glibc. I.e. kterms way of changing the locale again
internally does really cause problems in some environments. 

Anyway, I think kterms way of changing the localle internally
behind the back of the user is a very weird, non-standard behaviour,
therefore I patched this in the SuSE kterm rpm to use

    setlocale(LC_CTYPE,"")

instead, i.e. use the locale set in the environment. Then of course,
you *must* start kterm with a Japanese locale otherwise XIM
won't work. But then kterm will also load Japanese app-defaults,
as it should be. To get English menus, you have to use English
app-defaults for kterm (preferably in your home directory). 

-- 
Mike Fabian   &lt;mfabian@example.com&gt;   <A HREF="http://www.suse.de/~mfabian">http://www.suse.de/~mfabian</A>
睡眠不足はいい仕事の敵だ。
</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00036" href="msg00036.html">Re: kinput and kterm SOLVED!!!!!</a></strong>
<ul><li><em>From:</em> Martin Baehr &lt;mbaehr@example.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00014" href="msg00014.html">kinput and kterm</a></strong>
<ul><li><em>From:</em> Martin Baehr &lt;mbaehr@example.com&gt;</li></ul></li>
<li><strong><a name="00018" href="msg00018.html">Re: kinput and kterm</a></strong>
<ul><li><em>From:</em> Mike Fabian &lt;mfabian@example.com&gt;</li></ul></li>
<li><strong><a name="00021" href="msg00021.html">Re: kinput and kterm</a></strong>
<ul><li><em>From:</em> Martin Baehr &lt;mbaehr@example.com&gt;</li></ul></li>
<li><strong><a name="00022" href="msg00022.html">Re: kinput and kterm</a></strong>
<ul><li><em>From:</em> Tobias Diedrich &lt;ranma@example.com&gt;</li></ul></li>
<li><strong><a name="00023" href="msg00023.html">Re: kinput and kterm</a></strong>
<ul><li><em>From:</em> Martin Baehr &lt;mbaehr@example.com&gt;</li></ul></li>
<li><strong><a name="00024" href="msg00024.html">Re: kinput and kterm</a></strong>
<ul><li><em>From:</em> Mike Fabian &lt;mfabian@example.com&gt;</li></ul></li>
<li><strong><a name="00026" href="msg00026.html">Re: kinput and kterm SOLVED!!!!!</a></strong>
<ul><li><em>From:</em> Martin Baehr &lt;mbaehr@example.com&gt;</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00033.html">Re: jvim+X, screen+kterm, screen+kinput, kinput and other apps</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00035.html">Re: jvim vs. vim 6</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00026.html">Re: kinput and kterm SOLVED!!!!!</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00036.html">Re: kinput and kterm SOLVED!!!!!</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00034"><strong>Date</strong></a></li>
<li><a href="threads.html#00034"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
