<!-- MHonArc v2.6.16 -->
<!--X-Subject: [tlug] how to tune reiser4 for millions of files? -->
<!--X-From-R13: [vpuny Vnwrx <unwrx1Nxneybi.zss.phav.pm> -->
<!--X-Date: Thu, 28 Jan 2010 16:39:24 +0900 -->
<!--X-Message-Id: 20100128073847.GH13095@wasi.karlov.mff.cuni.cz -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="Author" content="Jim Tittsler - listmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<P>
<TABLE BGCOLOR="#FFFF66" BORDER=1 COLS=1 WIDTH="90%" CLASS=navbar>
<TR>
<TD>&nbsp;&nbsp;
<FONT FACE="Verdana, Lucida Sans, Arial, Helvetica, Geneva, sans-serif"><SMALL>
<A HREF="../../index.html" TITLE="Tokyo Linux Users Group Page">
<STRONG>tlug.jp</STRONG></A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../../list.html" TITLE="Mailing List Page">Mailing List</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../index.html" TITLE="tlug Archive Page">tlug archive</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
tlug Mailing List Archive
</SMALL></FONT>
</TD></TR>
</TABLE>
<P>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00125.html">Date Prev</a>][<a href="msg00127.html">Date Next</a>][<a href="msg00124.html">Thread Prev</a>][<a href="msg00127.html">Thread Next</a>][<a href="maillist.html#00126">Date Index</a>][<a href="threads.html#00126">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[tlug] how to tune reiser4 for millions of files?</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li>Date: Thu, 28 Jan 2010 08:38:47 +0100</li>
<li><strong>From</strong>: <strong>Michal Hajek &lt;<a href="mailto:hajek1@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20how%20to%20tune%20reiser4%20for%20millions%20of%20files%3F">hajek1@example.com</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>[tlug] how to tune reiser4 for millions of files?</strong></li>
<li>User-agent: Mutt/1.5.18 (2008-05-17)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
Hello, 

is there any hope to manage nearly 7 million of files in one directory 
by tuning reiser4 fs?

Situation: somebody wrote incredibly stupid application which analyzes
some measurement data by producing 7032034 small text files into one
directory. Now we need to analyze that data &quot;en block&quot;, that is, we
cannot split it into many dirs. Also we need it somewhat soon. That is,
hopefuly before the proces of rewriting the above mentioned stupid
application comes to an end (could take months). Right now I employed
reiser4 fs on a scsi disk array in default configuration. Still `ls -l`
takes more than 6 hours - more accurately, after 6 hours I lost my
patience and killed it.

So I wonder if by moving that whole dir to another place (it totals to
approximately 74GB) and tuning some parameters of reiser4 fs, I could 
get noticably better performance.

I measure the performance by iotop, and top mostly (feel free to give
advice on this). 

one example:

$iotop -o 
5738 root     1818.83 K/s       0 B/s  0.00 % 97.30 % evn421 40,47,52,57,0 /mnt/polea/out/data-0000001

(97.30 %  is io waiting time - I suggest it is because fs deals with
millions of files )

$top
 5738 root      20   0 2018m 2.0g  488 D    4 12.6  16:31.31 evn421  
 (4 = cpu usage of &quot;evn421&quot;)

also top shows
 Cpu0  :  0.7%us,  1.7%sy,  0.0%ni,  0.0%id, 97.0%wa,  0.3%hi,  0.3%si, 0.0%st
 

Best regards
Michal

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00127" href="msg00127.html">Re: [tlug] how to tune reiser4 for millions of files?</a></strong>
<ul><li><em>From:</em> Curt Sampson</li></ul></li>
<li><strong><a name="00151" href="msg00151.html">Re: [tlug] how to tune reiser4 for millions of files?</a></strong>
<ul><li><em>From:</em> Curt Sampson</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00125.html">Re: [tlug] OSS network visualization software,	WAS: [Semi-OT] Network 	connectivity diagnosis</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00127.html">Re: [tlug] how to tune reiser4 for millions of files?</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00124.html">Re: [tlug] TSAC meeting: January 28th</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00127.html">Re: [tlug] how to tune reiser4 for millions of files?</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00126"><strong>Date</strong></a></li>
<li><a href="threads.html#00126"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="/list.html"> Mailing List </a></td>
<td align=center><a href="http://tlug.jp/linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="http://tlug.jp/members.html">TLUG Members</a></td>
<td align=center><a href="http://tlug.jp//linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
