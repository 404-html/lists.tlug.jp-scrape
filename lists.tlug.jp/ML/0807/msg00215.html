<!-- MHonArc v2.6.10 -->
<!--X-Subject: Re: [tlug] STM (was: Re: work times &#38; accommodation @tokyo) -->
<!--X-From-R13: Qheg Enzcfba <pwfNfgneyvat&#45;fbsgjner.pbz> -->
<!--X-Date: Tue, 29 Jul 2008 01:02:51 +0900 -->
<!--X-Message-Id: 20080728160250.GB26262@lucky.cynic.net -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 87fxpzx9mt.fsf@uwakimon.sk.tsukuba.ac.jp -->
<!--X-Reference: 20080727120405.752622d9.attila@kinali.ch -->
<!--X-Reference: 20080727223043.GK4228@pragmatic.cynic.net -->
<!--X-Reference: d8fcc0800807280002v3f14071dk3b2c9e47ac3269c8@mail.gmail.com -->
<!--X-Reference: 20080728080316.GA16586@lucky.cynic.net -->
<!--X-Reference: d8fcc0800807280309j3d410857w9b9e5fdd3462316a@mail.gmail.com -->
<!--X-Reference: 20080728114336.GA18114@lucky.cynic.net -->
<!--X-Reference: d8fcc0800807280554m1db06f1aq3a58205b1f9861ea@mail.gmail.com -->
<!--X-Reference: 20080728144249.GA26262@lucky.cynic.net -->
<!--X-Reference: d8fcc0800807280805g11e1165cg7252a6b9c9017771@mail.gmail.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="Author" content="Jim Tittsler - listmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<P>
<TABLE BGCOLOR="#FFFF66" BORDER=1 COLS=1 WIDTH="90%" CLASS=navbar>
<TR>
<TD>&nbsp;&nbsp;
<FONT FACE="Verdana, Lucida Sans, Arial, Helvetica, Geneva, sans-serif"><SMALL>
<A HREF="../../index.html" TITLE="Tokyo Linux Users Group Page">
<STRONG>tlug.jp</STRONG></A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../../list.html" TITLE="Mailing List Page">Mailing List</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../index.html" TITLE="tlug Archive Page">tlug archive</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
tlug Mailing List Archive
</SMALL></FONT>
</TD></TR>
</TABLE>
<P>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00214.html">Date Prev</a>][<a href="msg00216.html">Date Next</a>][<a href="msg00214.html">Thread Prev</a>][<a href="msg00217.html">Thread Next</a>][<a href="maillist.html#00215">Date Index</a>][<a href="threads.html#00215">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li>Date: Tue, 29 Jul 2008 01:02:50 +0900</li>
<li><strong>From</strong>: <strong>Curt Sampson &lt;<a href="mailto:cjs@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20STM%20%28was:%20Re:%20work%20times%20%26%20accommodation%20%40tokyo%29">cjs@example.com</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</strong></li>
<li>References: &lt;<a href="msg00180.html">87fxpzx9mt.fsf@uwakimon.sk.tsukuba.ac.jp</a>&gt;	&lt;<a href="msg00191.html">20080727120405.752622d9.attila@kinali.ch</a>&gt;	&lt;<a href="msg00204.html">20080727223043.GK4228@pragmatic.cynic.net</a>&gt;	&lt;<a href="msg00207.html">d8fcc0800807280002v3f14071dk3b2c9e47ac3269c8@mail.gmail.com</a>&gt;	&lt;<a href="msg00208.html">20080728080316.GA16586@lucky.cynic.net</a>&gt;	&lt;<a href="msg00210.html">d8fcc0800807280309j3d410857w9b9e5fdd3462316a@mail.gmail.com</a>&gt;	&lt;<a href="msg00211.html">20080728114336.GA18114@lucky.cynic.net</a>&gt;	&lt;<a href="msg00212.html">d8fcc0800807280554m1db06f1aq3a58205b1f9861ea@mail.gmail.com</a>&gt;	&lt;<a href="msg00213.html">20080728144249.GA26262@lucky.cynic.net</a>&gt;	&lt;<a href="msg00214.html">d8fcc0800807280805g11e1165cg7252a6b9c9017771@mail.gmail.com</a>&gt;</li>
<li>User-agent: Mutt/1.5.17 (2007-11-01)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>On 2008-07-28 08:05 -0700 (Mon), Josh Glover wrote:

&gt; It does indirectly, unless I am misunderstanding you altogether (which
&gt; is entirely possible). I would hazard that a lot of your locking
&gt; problems originated from attempts to parallellise algorithms, right?

Nope. This was back in '99 and 2000: we were running everything except
our database servers on single-core, single-CPU systems at the time, so
no parallelism was available.

Our multi-threaded stuff was entirely due to blocking IO: we needed
different threads for each dynamic HTTP request, due to blocking on IO
to the web server, the DBMS, and a few other things, we had separate
threads for a control console built into each server that let us inspect
things and change configuration parameters on the fly, and so on. The
locking issues came in with shared data such as DBMS connections (that
one was a real ouchie), shared large data structures (or even smaller
ones such as sessions), and so on.

&gt; There are certainly other uses for threads and the necessity of
&gt; locking that they breed, but I guess that parallellisation is one of
&gt; the major use cases.

Maybe if you do everything in an event-driven framework. :-) Java, early
on, was never very amenable to that.

&gt; Fork/join gives you that for free, and handles the locking with no
&gt; explicit code on your part.

Fork/join handles no locking at all. If two separate threads spawned by
that access the same data structure at the same time, and you haven't
taken care of all of the locking, you're in big trouble.

&gt; I guess this is how GHC's &quot;par&quot; works, right?

Nope. `par` offers no locking; you need to use explicitly shared data
structures and locks. The reason par works so well in Haskell is the
style of the language: since you're writing mostly pure code (&quot;pure&quot;,
by the way, is a term of art here) you don't modify existing data
structures, you copy what you need new versions of. Note that this does
not preclude data sharing, in fact it encourages it in that the new
versions will re-use existing data wherever they can.

&gt; What other languages have something analogous to &quot;par&quot;?

In the sense of, &quot;spark a separate thread for doing this,&quot; lots.
In the sense of threads being that lighweight, not all that many
implementations, I'd imagine. (A GHC thread uses only a few hundred
bytes of memory, and it's fine to spark several thousand of them.) In
the sense of making it that easy to use, i.e., changing

    fib n = fib (n-1) + fib (n-2)

to

    fib n = r `par` (l `pseq` l+r)
        where
            l = fib (n-1)
            r = fib (n-2)

I don't know of anything off-hand.

&gt; For that matter, what languages are supported by GHC? Just Haskell, or
&gt; other languages in that family?

Just Haskell. Though, come to think of it, you probably could tack
on a new front end that compiles something else to its &quot;primitive&quot;
Haskell-like code and then use the rest of GHC to compile that.

Oh, BTW, while we're talking about parallelism, I should mention
that GHC now has parallel GC implemented (as in, GC that still stops
everything else, but uses multiple cores to do the collection faster
than a single core could do it alone) and it will be released with GHC
6.10 this fall. It apparently gives GC about a 20% speedup on a two-core
machine, and 45% on a four-core.

cjs
-- 
Curt Sampson       &lt;cjs@example.com&gt;        +81 90 7737 2974   
Mobile sites and software consulting: <a  href="http://www.starling-software.com">http://www.starling-software.com</a>

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00217" href="msg00217.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
<ul><li><em>From:</em> Josh Glover</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00180" href="msg00180.html">Re: work times &amp; accommodation @tokyo, WAS: Re: [tlug] Embedded	linux dev wanting to find work in Tokyo.. Seeking advice.</a></strong>
<ul><li><em>From:</em> Stephen J. Turnbull</li></ul></li>
<li><strong><a name="00191" href="msg00191.html">[tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
<ul><li><em>From:</em> Attila Kinali</li></ul></li>
<li><strong><a name="00204" href="msg00204.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
<ul><li><em>From:</em> Curt Sampson</li></ul></li>
<li><strong><a name="00207" href="msg00207.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
<ul><li><em>From:</em> Josh Glover</li></ul></li>
<li><strong><a name="00208" href="msg00208.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
<ul><li><em>From:</em> Curt Sampson</li></ul></li>
<li><strong><a name="00210" href="msg00210.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
<ul><li><em>From:</em> Josh Glover</li></ul></li>
<li><strong><a name="00211" href="msg00211.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
<ul><li><em>From:</em> Curt Sampson</li></ul></li>
<li><strong><a name="00212" href="msg00212.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
<ul><li><em>From:</em> Josh Glover</li></ul></li>
<li><strong><a name="00213" href="msg00213.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
<ul><li><em>From:</em> Curt Sampson</li></ul></li>
<li><strong><a name="00214" href="msg00214.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
<ul><li><em>From:</em> Josh Glover</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00214.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00216.html">[tlug] [SOLVED] Skype 2.x video calling in Linux</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00214.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00217.html">Re: [tlug] STM (was: Re: work times &amp; accommodation @tokyo)</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00215"><strong>Date</strong></a></li>
<li><a href="threads.html#00215"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
