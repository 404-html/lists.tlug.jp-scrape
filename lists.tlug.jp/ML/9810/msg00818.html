<!-- MHonArc v2.2.0 -->
<!--X-Subject: Re: tlug: CODA distributed filesystem -->
<!--X-From: Frank Bennett <bennett@example.com&#45;u.ac.jp> -->
<!--X-Date:  Tue, 20 Oct 1998 18:13:09 +0900 -->
<!--X-Message-Id: m3r9w3oarr.fsf@example.com&#45;u.ac.jp -->
<!--X-ContentType: text/plain -->
<!--X-Reference-Id: 199810200824.RAA02808@example.com&#45;u.ac.jp -->
<!--X-Reference-Id: 13868.19300.347104.531416@example.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-type" content="text/html">
  <meta name="Author" content="Jim Schweizer - webmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<!--X-Body-Begin-->
<!--X-User-Header-->
<P>
<font color="blue">
Support open source code!
</font>
<!--X-User-Header-End-->
<!--X-TopPNI-->
<HR>
[<A HREF="msg00817.html">Date Prev</A>][<A HREF="msg00819.html">Date Next</A>][<A HREF="msg00816.html">Thread Prev</A>][<A HREF="msg00830.html">Thread Next</A>][<A HREF="maillist.html#00818">Date Index</A>][<A HREF="threads.html#00818">Thread Index</A>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<H1>Re: tlug: CODA distributed filesystem</H1>
<HR>
<!--X-Subject-Header-End-->
<UL>
<LI><strong>To</strong>: <strong><A HREF="mailto:tlug@example.com">tlug@example.com</A></strong></LI>
<LI><strong>Subject</strong>: <strong>Re: tlug: CODA distributed filesystem</strong></LI>
<LI><strong>From</strong>: <strong>Frank Bennett &lt;<A HREF="mailto:bennett@example.com">bennett@example.com</A>&gt;</strong></LI>
<LI>Date: 20 Oct 1998 18:14:32 +0900</LI>
<LI>Content-Type: text/plain; charset=US-ASCII</LI>
<LI>In-Reply-To: "Stephen J. Turnbull"'s message of "Tue, 20 Oct 1998 17:35:48 +0900 (JST)"</LI>
<LI>References: &lt;<A HREF="msg00813.html">199810200824.RAA02808@example.com</A>&gt;&lt;<A HREF="msg00816.html">13868.19300.347104.531416@example.com</A>&gt;</LI>
<LI>Reply-To: <A HREF="mailto:tlug@example.com">tlug@example.com</A></LI>
<LI>Sender: <A HREF="mailto:owner-tlug@example.com">owner-tlug@example.com</A></LI>
</UL>
<!--X-Head-Body-Sep-Begin-->
<HR>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<PRE>
"Stephen J. Turnbull" &lt;turnbull@example.com&gt; writes:

&gt;     Frank&gt; I have written up a set of notes on installation, which I
&gt;     Frank&gt; will happily send to anyone who wants them.
&gt; 
&gt; Post 'em, we[1] need more technical info on this list.  :-)

SOME NOTES ON BUILDING CODA

*** First: what is CODA?  Here's the announcement of the latest
release (search for *** to skip to the next section of these
notes):

This is to announce Coda 4.6.6.  
--------------------------------

Coda is a distributed filesystem with novel features such as disconnected
operation and server replication.  For many details about Coda see
<A TARGET="_top" HREF="http://www.coda.cs.cmu.edu">http://www.coda.cs.cmu.edu</A>. 

Coda currently runs on FreeBSD(i386), Linux(i386,sparc) and NetBSD(i386).
Ports to Windows(95,NT) are in progress.

What happened since Coda 4.6.5 our previous "stable" release?

- For this 4.6.6 release, Coda works on current versions of both FreeBSD
  and NetBSD platforms.  There is direct kernel support as well as lkm's
  for kernel features.  The packages/port system can be used to obtain
  and/or build Coda.  Coda is in the package/port tree under: 
	net/coda_intro, net/coda_client, net/coda_server, net/coda_doc

- We've also taken a couple of the fixes for various small, but annoying,
  bugs from the development version.

- We fixed (and probably broke) some things in the various server setup
  scripts, but they are better than before.

As always, this version is MUCH better than 4.6.5, try it!!

It has been released in binary form for:
 Linux binary rpm's
 FreeBSD 3.0 (a.out &amp; elf) packages!
 NetBSD current pre-compiled packages

It can be found at: 
<A TARGET="_top" HREF="ftp://ftp.coda.cs.cmu.edu/pub/coda/[your">ftp://ftp.coda.cs.cmu.edu/pub/coda/[your</A> platform]

Documention in cpio and rpm format:
<A TARGET="_top" HREF="ftp://ftp.coda.cs.cmu.edu/pub/coda/doc">ftp://ftp.coda.cs.cmu.edu/pub/coda/doc</A>

For all other platforms and architectures:

		Use the source.
	<A TARGET="_top" HREF="ftp://ftp.coda.cs.cmu.edu/pub/src">ftp://ftp.coda.cs.cmu.edu/pub/src</A>

By the way, we keep snapshots of our ongoing development here
as well.  So if you want to build/run the latest Coda check out
the 4.7.x branch.
-------------------------------------------------------------------------

What's next?  

The snapshots show you where we are going. Jan continues to fix
tricky bugs in Venus related to disconnected operation and reintegration.
The new directory code is still being improved.  We are also working
on clients for 95 and NT. 

Integrating more of the patches we've been sent (Thanks guys!).

---------------------------------------------------------------------

Have fun!

The Coda Group. 

Contacts:
Peter Braam, braam@example.com
Jan Harkes,  jaharkes@example.com
Bob Baron,   rvb@example.com

*** HOW CAN I RUN CODA ON TL 2.0?

The binary RPMs are reputed to be built for RedHat 5.0 and to
work also under 5.1.  But in case anyone wants to build CODA from
scratch, here are some notes about what I think I did to get
things up and running under TL 2.0, at least.

First, fetch the sources ...

  ftp ftp.coda.cs.cmu.edu

  cd /pub/coda/src

[or]

  cd /pub/coda/linux/SRPMS

Then either get:

   coda-4.6.6.tgz

OR get:

   coda-debug-4.6.6-1.src.rpm

and one of

   coda-fs-module-k2.0.32_c4.6.0-1.src.rpm
   coda-fs-module-k2.0.34_c4.6.0-1.src.rpm
   coda-fs-module-k2.0.35_c4.7.0-3.src.rpm

and the docs in the same subdirectory --- they won't tell you
everything you need to know, but the more docs the better, right?

I did my build using the raw sources, not the RPMs.  There are
warnings in the docs about the need to use quite specific tools
to do the build, including a CMU version of "make", but things
SEEM to have worked with the GNU kit in TL-2.0 (he said --- this
is still EXPERIMENTAL STUFF though, so don't trust it, or me, in
ANY case).

To build, I went to the top of the source hierarchy after
unpacking, and did a ./configure.  Then I did "make", and found
that the compile kept failing for want of headers that were
scattered throughout the sources.  Obviously some paths are
wanted, but I hacked things into compilable order with the
following script, run from INSIDE a directory ./include, which I
created at the top of the Coda source hierarchy:

#!/bin/bash
# File: make-includes
rm -f *.h
rm -f cfs/*.h
for h in lib-src/mlwp lib-src/special-includes rvm-src coda-src ; do
  for i in `find ../ -name "*.h" | grep $h` ; do
    ln -s $i
  done
done
mkdir cfs
cd cfs
for h in kernel-src/vfs/linux/cfs kernel-src/vfs/includes ; do
  for i in `find ../../ -name "*.h" | grep $h` ; do
    ln -s $i
  done
done
cd ..

CAUTION: you need to make a subdirectory ./include at the top of
the CODA source hierarchy, copy this script into it, cd to the
./include subdirectory and then run the script.  This script uses
"rm -f" --- DON'T run it from anywhere else!!!!!

You will now be able to cd .. and run make more successfully.
Things will fail again, once or twice.  The make generates a
couple of header files on the fly, which you need to pick up by
rerunning make-includes.  To do this, cd to ./include again and
run ./make-includes from that directory, then cd .. and type
"make" again.

Once everything's built, you can install with "make
client-install".

Next, you need to build the kernel module.  I think you need the
kernel sources that match your module source number.  There's
probably a script around in there somewhere that tells how to do
this cleanly, but to hack up a module I did (from the top of the
coda source hierarchy):
  
  cd kernel-src/vfs
  touch .prereq.ok
  cd linux
  ln -s ../includes linux
  make coda.o

It seems to work :-|.

Copy the module into your /lib/modules hierarchy, and do insmod
on it, then lsmod to be sure its made it into the running kernel.

There's a file that ships with the binaries that tells how to set
up the client and test its operation.  This is as far as I've
gotten.  Here's the portion on testing the client:

           On a client run the script /usr/sbin/venus-setup.

	     venus-setup &lt;comma,separated,hosts&gt; &lt;cachesizeinkb&gt;

           NOTE: the cache size should be at least 10000, but
           preferably more. 

           You can test your client installation by connecting to
           the testserver at CMU:
           
             venus-setup testserver.coda.cs.cmu.edu 40000

	   I strongly recommend you to try that first. 

	   Also test if your kernel module matches your kernel:

              insmod coda 
              lsmod coda

           should proceed without errors and show a Coda module 
           in the kernel.  If not recompile the kernel module, 
           read README.kernel-module. 

           Start Venus with
               venus &amp;
           Follow the log with
               tail -f /usr/coda/venus.log
           Type 
               codacon 
           in an xterm to see the actions. 
	
	   You can turn up debugging with 
               coda-debug 4095 (see coda_linux.h for the bitmask)
               coda-trace 1
           (these set constants in /proc/sys/coda/?)
	
	   NOTE: Please make sure your have enough free space on the
                 filesystem in which /usr/coda/venus.cache resides for the
                 cache-size indicated.  That is, if you specify 20000 for 
                 for twenty-thousand kilobytes, this means you must have at
	         least 20MB of free on the partition containing venus.cache.

	   See above how to point your client at your own server.

I haven't gotten a server up yet --- I have to dust off an SS5
and install Linux on it, and string some extra disks off of it
first.  More later.

*** SO IT'S RUNNING THE CLIENT --- BIG DEAL

You're next question is likely to be something like, "Okay, I've
DONE all of that, and it all seems to work.  Now where's this
shared filesystem that everyone's been talking about?  Or is it
securely known only to the kernel, and not for use by outsiders
or something?  What's the deal?"

At the top of your file hierarchy on your machine, you should
find a directory /coda.  Cd down from here, and you're inside the
distributed filesystem.

*** HOW DO I SHUT THE DARNED THING DOWN?

Use "vutil -shutdown" to stop the client.  You should then always
explictly unmount the filesystem with "umount /coda"; if it
doesn't unmount when the server is stopped (it never seems to for
me), the mount will block the client the next time you try to
start it up.

Enjoy!
-- 
-x80
Frank G Bennett, Jr         @@
Faculty of Law, Nagoya Univ () email: bennett@example.com
Tel: +81[(0)52]789-2239     () WWW:   <A TARGET="_top" HREF="http://rumple.soas.ac.uk/~bennett/">http://rumple.soas.ac.uk/~bennett/</A>
---------------------------------------------------------------
Next Nomikai: 20 November, 19:30 Tengu TokyoEkiMae 03-3275-3691
Next Meeting: 12 December, 12:30 Tokyo Station Yaesu central gate
---------------------------------------------------------------
Sponsor: PHT, makers of TurboLinux <A TARGET="_top" HREF="http://www.pht.co.jp">http://www.pht.co.jp</A>

</PRE>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<HR>
<UL><LI><STRONG>Follow-Ups</STRONG>:
<UL>
<LI><STRONG><A NAME="00830" HREF="msg00830.html">Re: tlug: CODA distributed filesystem</A></STRONG>
<UL><LI><EM>From:</EM> Frank Bennett &lt;bennett@example.com&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-Follow-Ups-End-->
<!--X-References-->
<UL><LI><STRONG>References</STRONG>:
<UL>
<LI><STRONG><A NAME="00813" HREF="msg00813.html">tlug: CODA distributed filesystem</A></STRONG>
<UL><LI><EM>From:</EM> Frank Bennett &lt;bennett@example.com&gt;</LI></UL></LI>
<LI><STRONG><A NAME="00816" HREF="msg00816.html">tlug: CODA distributed filesystem</A></STRONG>
<UL><LI><EM>From:</EM> "Stephen J. Turnbull" &lt;turnbull@example.com&gt;</LI></UL></LI>
</UL></LI></UL>
<!--X-References-End-->
<!--X-BotPNI-->
<UL>
<LI>Prev by Date:
<STRONG><A HREF="msg00817.html">Re: tlug: CODA distributed filesystem</A></STRONG>
</LI>
<LI>Next by Date:
<STRONG><A HREF="msg00819.html">Re: tlug: CODA distributed filesystem</A></STRONG>
</LI>
<LI>Prev by thread:
<STRONG><A HREF="msg00816.html">tlug: CODA distributed filesystem</A></STRONG>
</LI>
<LI>Next by thread:
<STRONG><A HREF="msg00830.html">Re: tlug: CODA distributed filesystem</A></STRONG>
</LI>
<LI>Index(es):
<UL>
<LI><A HREF="maillist.html#00818"><STRONG>Date</STRONG></A></LI>
<LI><A HREF="threads.html#00818"><STRONG>Thread</STRONG></A></LI>
</UL>
</LI>
</UL>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
