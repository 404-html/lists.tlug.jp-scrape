<!-- MHonArc v2.6.16 -->
<!--X-Subject: Re: [tlug] Making sure people get the message -->
<!--X-From-R13: <fgrcuraNkrznpf.bet> -->
<!--X-Date: Mon, 02 Oct 2006 12:35:17 +0900 -->
<!--X-Message-Id: 17696.35385.657311.292975@example.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 451E71F4.8090202@example.com -->
<!--X-Reference: 17694.40600.245599.76700@example.com -->
<!--X-Reference: 20060930211732.15ac4b70.jep200404@example.com -->
<!--X-Reference: 451F5F4A.6040403@example.com -->
<!--X-Reference: 20061001112537.003930ef.godwin.stewart@example.com -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-type" content="text/html">
  <meta name="Author" content="Jim Tittsler - listmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<P>
<TABLE BGCOLOR="#FFFF66" BORDER=1 COLS=1 WIDTH="90%" CLASS=navbar>
<TR>
<TD>&nbsp;&nbsp;
<FONT FACE="Verdana, Lucida Sans, Arial, Helvetica, Geneva, sans-serif"><SMALL>
<A HREF="../../index.html" TITLE="Tokyo Linux Users Group Page">
<STRONG>tlug.jp</STRONG></A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../../list.html" TITLE="Mailing List Page">Mailing List</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../index.html" TITLE="tlug Archive Page">tlug archive</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
tlug Mailing List Archive
</SMALL></FONT>
</TD></TR>
</TABLE>
<P>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00032.html">Date Prev</a>][<a href="msg00034.html">Date Next</a>][<a href="msg00009.html">Thread Prev</a>][<a href="msg00043.html">Thread Next</a>][<a href="maillist.html#00033">Date Index</a>][<a href="threads.html#00033">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [tlug] Making sure people get the message</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li>Date: Mon, 2 Oct 2006 12:40:41 +0900</li>
<li><strong>From</strong>: <strong>&lt;<a href="mailto:stephen@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Making%20sure%20people%20get%20the%20message">stephen@example.com</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [tlug] Making sure people get the message</strong></li>
<li>References: &lt;<a href="mailto:451E71F4.8090202@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Making%20sure%20people%20get%20the%20message">451E71F4.8090202@example.com</a>&gt;	&lt;<a href="mailto:17694.40600.245599.76700@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Making%20sure%20people%20get%20the%20message">17694.40600.245599.76700@example.com</a>&gt;	&lt;<a href="mailto:20060930211732.15ac4b70.jep200404@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Making%20sure%20people%20get%20the%20message">20060930211732.15ac4b70.jep200404@example.com</a>&gt;	&lt;<a href="mailto:451F5F4A.6040403@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Making%20sure%20people%20get%20the%20message">451F5F4A.6040403@example.com</a>&gt;	&lt;<a href="mailto:20061001112537.003930ef.godwin.stewart@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Making%20sure%20people%20get%20the%20message">20061001112537.003930ef.godwin.stewart@example.com</a>&gt;</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Before I get into the discussion of SMTP, Dave, I hate to tell you
this but having a server subdomain of the &quot;.info&quot; or &quot;.biz&quot; domains
is probably going to cost points with spam filters.  I don't think
I've ever received a legit mail from either one, not even by mailing
list.  Even the Chinese numerical domains (163.com, 126.com, and
263.com) are less spammy in that sense.

The sender address &quot;info&quot; also reeks of spam.  Mailboxes like &quot;sales&quot;,
&quot;info&quot;, and &quot;service&quot; are great for *inbound* mail, of course, but
a sender address should be a mailbox that tells you why you want to
read it, either a personal name or a topic-specific mailing list name.
Even &quot;tokyohockey@example.com&quot; is a better choice from this point
of view.

Regarding encodings, UTF-8 should be OK AFAIK.  Japanese spammers
mostly use Shift JIS in my experience.

Godwin Stewart writes:

 &gt; On Sun, 01 Oct 2006 15:25:14 +0900, Dave M G &lt;martin@example.com&gt;
 &gt; wrote:
 &gt; 
 &gt; &gt; I don't quite understand why it says &quot;Received: from nobody&quot; when the 
 &gt; &gt; &quot;From&quot; header has &quot;info@example.com&quot;.
 &gt; 
 &gt; That's because the SMTP envelope sender doesn't have to have anything
 &gt; to do with the &quot;From:&quot; header in the data.
 &gt; 
 &gt; This is &quot;SMTP 101&quot;.

C'mon, Godwin, be a little helpful.  He says he doesn't know.  (BTW, I
believe that the user in the Received header is a user, not a mailbox,
which is why it's normally only present for the initiating user and
.forwards etc.)

Dave, there are a large number of technologies and even more standards
involved in getting content from you to me by email.  As is usual in
computer technology, there is a lot of modularization, or more in line
with communications technology, layering.  Without being excessively
pedantic about the technicalities, and mixing standard terms with some
I've made up for my convenience, for the problem of running a mailing
list and dealing with spam, there are three layers: the platform (the
hardware and software that deal with the Internet), the mail transfer
agent (&quot;MTA&quot;, eg, Sendmail, exim, Postfix) which talks to other MTAs
via the platform over the Internet, and the mail user agent (&quot;MUA&quot;),
which might be interactive (like Pine, Evolution, or Outlook Express),
or automated (like Mailman or your script).  We'll call the automated
ones &quot;mailing list managers&quot; (&quot;MLM&quot;) since that fits your application.

Conceptually, a sending MTA accepts a fully-formatted message on
standard input (ie, if you have a message in dave.msg, you do
&quot;sendmail stephen@example.com &lt;dave.msg&quot; and I'll get the mail), and
then

1. Calls up the other user's MTA on port 25 (the SMTP port).
2. The other MTA initiates the SMTP protocol by announcing itself.
3. Your MTA announces itself with

    HELO davesbox.com

4. The remote responds with a handshake, and in some variants,
   information about extension it can handle:

    250 OK

5. Your MTA starts an individual transaction by announcing it has
   mail:

    MAIL FROM &lt;dave@example.com&gt;

   That is the &quot;envelope sender&quot;.  Officially it exists only
   in the transaction between MTAs, although there are a number of
   unofficial headers (especially the From pseudo-header in an mbox
   file, this is the one without a colon at the very beginning of the
   message headers---think of this as where you throw away the 
   envelope, but scribble some address information at the top margin
   of the letter) that may contain it.  The partner responds &quot;250 OK&quot;. 

6. Your MTA starts listing recipients:

    RCPT TO &lt;stephen@example.com&gt;

   and the partner responds &quot;250 OK&quot; to each one.  This is the
   &quot;envelope address&quot;.

7. Then your MTA says &quot;DATA&quot;, and send the entire formatted message it
   received on standard input to the partner *verbatim*, followed by a
   line containing exactly one period (no whitespace except for the
   trailing CRLF).

8. The receiving MTA then does the following:

    a. Adds an implementation-dependent &quot;Received&quot; header which may
       contain the Unix user which invoked the MTA as you observed.
       This is *not* an email address, except by accident (ie,
       usernames usually correspond to mailbox names).

    b1. Sends the message in the same way _with the same envelope
       sender and address as in steps 5 and 6 above_ (that's why this
       is conceptually &quot;on the envelope,&quot; because it doesn't change
       ever along the path to destination, but it's not in the
       message).

    OR

    b2. Checks for the presence of a Return-Path header, and if there
       isn't one adds a Return-Path header containing the envelope
       sender's address.  Then it puts the resulting message in a
       local user's mailbox.

All of the above is defined in RFC 2821, as the Simple Mail Transport
Protocol (SMTP).  There are more accurate examples in the RFC (I've
almost surely left some stuff out or gotten it wrong), but that gives
the basic flavor.

The important point is that the MTAs control only the Received headers
and may set the Return-Path.  Because of the layering, they are
designed[1] to neither know nor care about anything else.  Conversely,
because they come *after* the MUA in time, the MUA *cannot* know about
or affect those headers.  Thus, the envelope information + these
headers are entirely independent of the other headers and body content.

Everything else in the message except for those very limited headers
is put there by MUAs.  The body of the message, including any
attachments, is specified briefly in RFC 2822 and more flexibly in the
many MIME RFCs.  RFC 2822 is mostly concerned with message headers,
and provides for several kinds of address fields.  There is a Sender
field, which is the (single) mailbox of the (usually human) agent
&quot;responsible&quot; for transmitting the message.  Think of this agent as a
&quot;secretary&quot; if different from the author.  Typically it will be the
same as Return-Path.  There is a From field, which contains the
mailbox(es) of the author(s).  There is a Reply-To field, contain the
correspondence address.  (This is explicitly reserved to author by the
RFC, which is one reason why RFC sticklers hate mailing lists like
TLUG that change the Reply-To address to point to the list.)  Finally
there are a number of recipient fields, To, Cc, and Bcc, whose
semantic differences are irrelevant here.

So if you've been counting carefully, you'll find 5 different
&quot;sources&quot; for mail: the Unix user, the envelope sender, the header
Return-Path (but the only officially-defined value other than the
envelope sender is the empty path &lt;&gt;), the header Sender, and the
header From (and maybe the header Reply-To).  *If* the MUA conforms to
standard, they will have a certain relation to each other, but
pragmatically they are independent of each other.

The PHP mail module probably sets some headers (such as Date and
Message-Id) automatically, provides defaults for others if you don't
set them manually (From will usually default to the process's owner),
and finally allows you to add arbitrary headers it doesn't know about.
But in theory they are *all* under your control (eg, using the
&quot;sendmail &lt;msgfile&quot; method).

Footnotes: 
[1]  In fact, historically many MTAs violate this principle.  They'll
translate body content from one encoding to another, etc.  But such
manipulations are normally very limited.


</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00043" href="msg00043.html">Re: [tlug] Making sure people get the message</a></strong>
<ul><li><em>From:</em> Dave M G</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00000" href="msg00000.html">[tlug]  Making sure people get the message</a></strong>
<ul><li><em>From:</em> stephen</li></ul></li>
<li><strong><a name="00004" href="msg00004.html">Re: [tlug] Making sure people get the message</a></strong>
<ul><li><em>From:</em> Jim</li></ul></li>
<li><strong><a name="00006" href="msg00006.html">Re: [tlug] Making sure people get the message</a></strong>
<ul><li><em>From:</em> Dave M G</li></ul></li>
<li><strong><a name="00009" href="msg00009.html">Re: [tlug] Making sure people get the message</a></strong>
<ul><li><em>From:</em> Godwin Stewart</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00032.html">[tlug] Link Errata . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . (Re: Debian supported wireless PC Card)</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00034.html">Re: [tlug] run on startup, but not too early</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00009.html">Re: [tlug] Making sure people get the message</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00043.html">Re: [tlug] Making sure people get the message</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00033"><strong>Date</strong></a></li>
<li><a href="threads.html#00033"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
