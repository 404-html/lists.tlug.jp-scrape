<!-- MHonArc v2.6.10 -->
<!--X-Subject: [tlug] Truetype fonts and japanese vertical text (was: Re: [BUG]	libass: Japanese font with '@'&#45;Prefix rendered wrong]) -->
<!--X-From-R13: Fbovnf Rvrqevpu <enaznNgqvrqevpu.qr> -->
<!--X-Date: Mon, 15 Sep 2008 22:55:00 +0900 -->
<!--X-Message-Id: 20080915133156.GA18300@yamamaya.is&#45;a&#45;geek.org -->
<!--X-Content-Type: text/plain -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="Author" content="Jim Tittsler - listmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<P>
<TABLE BGCOLOR="#FFFF66" BORDER=1 COLS=1 WIDTH="90%" CLASS=navbar>
<TR>
<TD>&nbsp;&nbsp;
<FONT FACE="Verdana, Lucida Sans, Arial, Helvetica, Geneva, sans-serif"><SMALL>
<A HREF="../../index.html" TITLE="Tokyo Linux Users Group Page">
<STRONG>tlug.jp</STRONG></A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../../list.html" TITLE="Mailing List Page">Mailing List</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../index.html" TITLE="tlug Archive Page">tlug archive</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
tlug Mailing List Archive
</SMALL></FONT>
</TD></TR>
</TABLE>
<P>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00207.html">Date Prev</a>][<a href="msg00209.html">Date Next</a>][<a href="msg00203.html">Thread Prev</a>][<a href="msg00214.html">Thread Next</a>][<a href="maillist.html#00208">Date Index</a>][<a href="threads.html#00208">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>[tlug] Truetype fonts and japanese vertical text (was: Re: [BUG]	libass: Japanese font with '@'-Prefix rendered wrong])</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li>Date: Mon, 15 Sep 2008 15:31:57 +0200</li>
<li><strong>From</strong>: <strong>Tobias Diedrich &lt;<a href="mailto:ranma@DOMAIN.HIDDEN?SUBJECT=Re:%20%5Btlug%5D%20Truetype%20fonts%20and%20japanese%20vertical%20text%20%28was:%20Re:%20%5BBUG%5D%9libass:%20Japanese%20font%20with%20%27%40%27-Prefix%20rendered%20wrong%5D%29">ranma@example.com</a>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>[tlug] Truetype fonts and japanese vertical text (was: Re: [BUG]	libass: Japanese font with '@'-Prefix rendered wrong])</strong></li>
<li>User-agent: Mutt/1.5.18 (2008-05-17)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>Hi all,

maybe someone knowledgeable here can/wants to comment on this?
The substation alpha subtitle rendering engine used in MPlayer
currently handles vertical fonts wrong. (@-prefixed Truetype fonts)

Thanks,

Tobias

----- Forwarded message from Evgeniy Stepanov &lt;eugeni.stepanov@example.com&gt; -----

Message-Id: &lt;200809141809.13391.eugeni.stepanov@example.com&gt;
User-Agent: KMail/1.10.1 (Linux/2.6.27-2-generic; KDE/4.1.1; i686; ; )
Date: Sun, 14 Sep 2008 18:09:12 +0400
From: Evgeniy Stepanov &lt;eugeni.stepanov@example.com&gt;
To: Tobias Diedrich &lt;ranma+mplayer@example.com&gt;
Cc: mplayer-dev-eng@example.com
Subject: Re: [BUG] libass: Japanese font with '@'-Prefix rendered wrong

Hi,

On Monday 08 September 2008 23:31:28 Tobias Diedrich wrote:
&gt; I noticed that libass renders japanese 'top to bottom' text wrong:
&gt;
&gt; This is what mplayer does:
&gt; <a  href="http://uguu.de/~ranma/macrossf_18_lunar_mkv_libass_bug.png">http://uguu.de/~ranma/macrossf_18_lunar_mkv_libass_bug.png</a>
&gt;
&gt; This is Aegisub (which for some unknown reason renders 声 as the
&gt; completely wrong character even though it's ok in the script...):
&gt; <a  href="http://uguu.de/~ranma/macrossf_18_lunar_mkv_substationalpha.png">http://uguu.de/~ranma/macrossf_18_lunar_mkv_substationalpha.png</a>
&gt;
&gt; Apparently, if a japanese fontname starts with @, the @ is stripped
&gt; and all characters of the font are prerotated by 90 degree.
&gt; This only happens for CJK characters though:
&gt; <a  href="http://uguu.de/~ranma/macrossf_18_lunar_mkv_substationalpha2.png">http://uguu.de/~ranma/macrossf_18_lunar_mkv_substationalpha2.png</a>
&gt;
&gt; Here are two screenshots of the font dialog to illustrate that:
&gt; Font with @-Prefix (Note the sample area (サンプル)):
&gt; <a  href="http://uguu.de/~ranma/macrossf_18_lunar_mkv_substationalpha3.png">http://uguu.de/~ranma/macrossf_18_lunar_mkv_substationalpha3.png</a>
&gt; Same font without @-Prefix:
&gt; <a  href="http://uguu.de/~ranma/macrossf_18_lunar_mkv_substationalpha4.png">http://uguu.de/~ranma/macrossf_18_lunar_mkv_substationalpha4.png</a>
&gt;
&gt; This is the fansubs I used for the screenshots and where I extracted the
&gt; script+fonts from:
&gt; <a  href="http://a.scarywater.net/lunar/%5BLunar%5D%20Macross%20Frontier%20-%2018%20%">http://a.scarywater.net/lunar/%5BLunar%5D%20Macross%20Frontier%20-%2018%20%</a>
&gt;5B1280x720%5D%5Bx264%5D%5BBF46689A%5D.mkv.torrent
&gt;
&gt; I had a cursory glance at the code and I think it might be a bit
&gt; more involving to add rotation based on fontname (and so far I haven't
&gt; found the time to dig into the code a bit more), so I'm posting it
&gt; to the list now. :)

It seems, according to
<a  href="http://blogs.msdn.com/michkap/archive/2005/08/04/447759.aspx">http://blogs.msdn.com/michkap/archive/2005/08/04/447759.aspx</a>
not all CJK glyphs have to be rotated. It is probably controlled by &quot;vrt2&quot; 
feature in GSUB table. This feature defines substitution of glyphs for vertical 
writing. As I guess, one needs to apply this substitution and then rotate all 
glyphs by 90 degrees.

This article
<a  href="http://www.microsoft.com/OpenType/OTSpec/features_uz.htm#vrt2">http://www.microsoft.com/OpenType/OTSpec/features_uz.htm#vrt2</a>
suggests that latin characters (among others) should be substituted by 
themselves rotated 90 degrees _clockwise_. Thus, the described procedure will 
result in horizontally oriented glyphs.

Can anyone confirm that this is the right way to deal with vertical text?

Unfortunately, FreeType does not parse GSUB table, so it has to be done in 
libass (or an OpenType library like HarfBuzz should be used). Or we could go 
the easy way and define a set of characters that should not be rotated (in 
addition to non-CJK characters, it includes half-width kana, various CJK 
punctuation marks and probably more). This is not reliable, but might work in 
practice.

----- End forwarded message -----

-- 
Tobias						PGP: <a  href="http://9ac7e0bc.uguu.de">http://9ac7e0bc.uguu.de</a>
このメールは十割再利用されたビットで作られています。

</pre>
<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<ul><li><strong>Follow-Ups</strong>:
<ul>
<li><strong><a name="00214" href="msg00214.html">Re: [tlug] Truetype fonts and japanese vertical text (was: Re:	[BUG] libass: Japanese font with '@'-Prefix rendered wrong])</a></strong>
<ul><li><em>From:</em> Stephen Lee</li></ul></li>
</ul></li></ul>
<!--X-Follow-Ups-End-->
<!--X-References-->
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00207.html">Re: [tlug] Setting up a RAID 1 with Ubuntu (Was: Hard Drive Failure)</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00209.html">Re: [tlug] Dinky computers</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00203.html">[tlug] ECO mode and microphone on the Let's Note Y7</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00214.html">Re: [tlug] Truetype fonts and japanese vertical text (was: Re:	[BUG] libass: Japanese font with '@'-Prefix rendered wrong])</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00208"><strong>Date</strong></a></li>
<li><a href="threads.html#00208"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
