<!-- MHonArc v2.5.2 -->
<!--X-Subject: Re: [tlug] Redhat Enterprise and PHPs MBSTRING -->
<!--X-From-R13: Dboreg Tvfure <eboregNvacunfr.wc> -->
<!--X-Date: Fri, 01 Apr 2005 10:13:50 +0900 -->
<!--X-Message-Id: 424CA04E.2010202@example.com -->
<!--X-Content-Type: text/plain -->
<!--X-Reference: 20050331.184847.670289635.dave@?om -->
<!--X-Reference: 424BCC89.9030604@example.com -->
<!--X-Reference: 20050331.232312.660286410.dave@?om -->
<!--X-Reference: 20050401.031745.524893293.dave@?om -->
<!--X-Head-End-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>TLUG Mailing List</title>
  <meta http-equiv="Content-type" content="text/html">
  <meta name="Author" content="Jim Tittsler - listmaster TLUG">
  <meta http-equiv="keywords" content="Tokyo Linux Users Group mailing list archive.">
</head>
 
<body bgcolor="#FFFFFF" text="#000000" BACKGROUND="../back3grnd.gif">
<BLOCKQUOTE>
<CENTER><IMG SRC="../tlug_logo.gif"><BR>Mailing List Archive</CENTER>
<P>
<TABLE BGCOLOR="#FFFF66" BORDER=1 COLS=1 WIDTH="90%" CLASS=navbar>
<TR>
<TD>&nbsp;&nbsp;
<FONT FACE="Verdana, Lucida Sans, Arial, Helvetica, Geneva, sans-serif"><SMALL>
<A HREF="../../index.html" TITLE="Tokyo Linux Users Group Page">
<STRONG>tlug.jp</STRONG></A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../../list.html" TITLE="Mailing List Page">Mailing List</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
<A HREF="../index.html" TITLE="tlug Archive Page">tlug archive</A> 
<IMG SRC="../../images/arrow_yellow.gif" WIDTH=13 HEIGHT=9 ALIGN=bottom ALT="-&gt;">
tlug Mailing List Archive
</SMALL></FONT>
</TD></TR>
</TABLE>
<P>
<!--X-Body-Begin-->
<!--X-User-Header-->
<!--X-User-Header-End-->
<!--X-TopPNI-->
<hr>
[<a href="msg00002.html">Date Prev</a>][<a href="msg00004.html">Date Next</a>][<a href="msg00000.html">Thread Prev</a>][<a href="msg00024.html">Thread Next</a>][<a href="maillist.html#00003">Date Index</a>][<a href="threads.html#00003">Thread Index</a>]
<!--X-TopPNI-End-->
<!--X-MsgBody-->
<!--X-Subject-Header-Begin-->
<h1>Re: [tlug] Redhat Enterprise and PHPs MBSTRING</h1>
<hr>
<!--X-Subject-Header-End-->
<!--X-Head-of-Message-->
<ul>
<li>Date: Fri, 01 Apr 2005 10:13:50 +0900</li>
<li><strong>From</strong>: <strong>Robert Fisher &lt;<A HREF="mailto:robert@DOMAIN.HIDDEN?SUBJECT=Re%3A%20%5Btlug%5D%20Redhat%20Enterprise%20and%20PHPs%20MBSTRING">robert@example.com</A>&gt;</strong></li>
<li><strong>Subject</strong>: <strong>Re: [tlug] Redhat Enterprise and PHPs MBSTRING</strong></li>
<li>References: &lt;20050331.184847.670289635.dave@?om&gt;	&lt;424BCC89.9030604@example.com&gt;	&lt;20050331.232312.660286410.dave@example.com&gt; &lt;<a href="msg00000.html">20050401.031745.524893293.dave@example.com</a>&gt;</li>
<li>User-agent: Mozilla Thunderbird 1.0 (X11/20041206)</li>
</ul>
<!--X-Head-of-Message-End-->
<!--X-Head-Body-Sep-Begin-->
<hr>
<!--X-Head-Body-Sep-End-->
<!--X-Body-of-Message-->
<pre>
David E wrote:

&gt;Replying to my own previous message...
&gt;
&gt;From: David E &lt;dave@?om&gt;
&gt;  
&gt;
&gt;&gt;From: Robert Fisher &lt;robert@example.com&gt;
&gt;&gt;Subject: Re: [tlug] Redhat Enterprise and PHPs MBSTRING
&gt;&gt;Date: Thu, 31 Mar 2005 19:10:17 +0900
&gt;&gt;
&gt;&gt;    
&gt;&gt;
&gt;&gt;&gt;David E wrote:
&gt;&gt;&gt;      
&gt;&gt;&gt;
&gt;&gt;&gt;&gt;From: Robert Fisher &lt;robert@example.com&gt;
&gt;&gt;&gt;&gt;        
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;David E wrote:
&gt;&gt;&gt;&gt;&gt;          
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;From: Robert Fisher &lt;robert@example.com&gt;
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;            
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;&gt;I am installing a system and for some reason we are having a problem 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;with encoding of japanese text to be sent out in emails.  The emails 
&gt;&gt;&gt;&gt;&gt;&gt;&gt;either come in &quot;mojibake&quot; or cutoff.  
&gt;&gt;&gt;&gt;&gt;&gt;&gt;              
&gt;&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;Have you checked the mb-related settings in the two php.ini files, and/or
&gt;&gt;&gt;&gt;&gt;&gt;compared the output of phpinfo() on the 2 systems?
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;&gt;            
&gt;&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Thanks for your response, yeah was the very first thing we did.  
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;&gt;Would the Locale of the server have any effect?  on both servers the 
&gt;&gt;&gt;&gt;&gt;locale is english utf8.
&gt;&gt;&gt;&gt;&gt;   
&gt;&gt;&gt;&gt;&gt;          
&gt;&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;I'd still be inclined to look for some difference between the two
&gt;&gt;&gt;&gt;systems in one of: the php code, php installation settings, php.ini settings.
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;As in Alessandro's example, is mb_language set to &quot;ja&quot; in both? Are
&gt;&gt;&gt;&gt;both using mb_send_mail rather than send_mail? That sort of thing. 
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;&gt;        
&gt;&gt;&gt;&gt;
&gt;&gt;&gt;mb_language is set to &quot;ja&quot; on both servers. and both servers are using 
&gt;&gt;&gt;mb_send_mail.
&gt;&gt;&gt;
&gt;&gt;&gt;I am actually trying to figure out why it is so different between the 
&gt;&gt;&gt;two servers.  We did however come up with a solution.  On the red hat 9 
&gt;&gt;&gt;server, we converted the body of the email to ISO-2022-JP  and the 
&gt;&gt;&gt;subject line was in EUC format before passing it through mb_send_mail.  
&gt;&gt;&gt;On the enterprise server, the solutions was to send the subject and body 
&gt;&gt;&gt;into mb_send_mail as EUC formatted.  I understand that mb_send_mail will 
&gt;&gt;&gt;convert the text to ISO-2022-JP format. 
&gt;&gt;&gt;
&gt;&gt;&gt;      
&gt;&gt;&gt;
&gt;&gt;I'd guess that passing in the subject and body in different encodings
&gt;&gt;could cause problems with the conversion. When mb tries to detect the
&gt;&gt;input encoding, it may just go with the first one it detects (either
&gt;&gt;the subject or the body) and then convert everything based on
&gt;&gt;that. 
&gt;&gt;
&gt;&gt;Since you know what encoding you're starting with, why not expressly
&gt;&gt;convert both the body and subject to ISO-2022-JP before passing them
&gt;&gt;to mb_send_mail and avoid the risk that mb's auto-detect might get it
&gt;&gt;wrong?
&gt;&gt;    
&gt;&gt;
&gt;
&gt;Actually, that last bit I wrote is probably wrong. mb_send_mail
&gt;probably expects the strings passed to it to be in whatever encoding
&gt;is set as the script/internal encoding (this might be clarified in the
&gt;docs or somewhere in the PHP i18n mailing list archives), and that's
&gt;why passing both in EUC works. As to why passing the body as JIS and
&gt;subject in EUC seems to work on the other system, uhhh Idunno, but I'd
&gt;try changing it (to EUC, EUC) on that system too, to see if it works
&gt;consinstently.
&gt;
&gt;-dave
&gt;
&gt;
&gt;  
&gt;
Dave,

Thanks for your input, it makes alot of sense.  I think I read somewhere 
before that mbstring will encode on the first one it detects.  Also in 
order to make it work on the redhat enterprise system, we had to set the 
internal encoding to EUC.   I will have it tested on our devel server 
and see if it will behave the same way.  Is it also possible that redhat 
enterprise is running more strict then say redhat 9?  For example, the 
httpd.conf file was being read as global overwrites all.  And something 
simple as the ps command we had to add -Awf to get the name of the 
programs to display the full text, where as on the redhat 9 we could 
just use -Af to get the same thing.  Again thanks for all of your time 
in this matter.

- Robert

</pre>

<!--X-Body-of-Message-End-->
<!--X-MsgBody-End-->
<!--X-Follow-Ups-->
<hr>
<!--X-Follow-Ups-End-->
<!--X-References-->
<ul><li><strong>References</strong>:
<ul>
<li><strong><a name="00000" href="msg00000.html">Re: [tlug] Redhat Enterprise and PHPs MBSTRING</a></strong>
<ul><li><em>From:</em> David E</li></ul></li>
</ul></li></ul>
<!--X-References-End-->
<!--X-BotPNI-->
<ul>
<li>Prev by Date:
<strong><a href="msg00002.html">[tlug] nessie - the loch ness monster of programming languages</a></strong>
</li>
<li>Next by Date:
<strong><a href="msg00004.html">[tlug] Wireless LAN - Signal strength seesaw</a></strong>
</li>
<li>Previous by thread:
<strong><a href="msg00000.html">Re: [tlug] Redhat Enterprise and PHPs MBSTRING</a></strong>
</li>
<li>Next by thread:
<strong><a href="msg00024.html">Re: [tlug] Redhat Enterprise and PHPs MBSTRING</a></strong>
</li>
<li>Index(es):
<ul>
<li><a href="maillist.html#00003"><strong>Date</strong></a></li>
<li><a href="threads.html#00003"><strong>Thread</strong></a></li>
</ul>
</li>
</ul>

<!--X-BotPNI-End-->
<!--X-User-Footer-->
<strong>
<a href="../index.html">Home</a> |
<a href="maillist.html">Main Index</a> |
<a href="threads.html">Thread Index</a>
</strong>
<!--X-User-Footer-End-->
 
<P>
<CENTER>
 <table border=2 width=75%><tr><td align=center>
<a href="../../index.html"> Home Page</a></td>
<td align=center><a href="../../list.html"> Mailing List </a></td>
<td align=center><a href="../../linuxinjapan.html"> Linux and Japan </a></td>
<td align=center><a href="../../members.html">TLUG Members</a></td>
<td align=center><a href="../../linuxlinks.html">Links</a></td>
</tr></TABLE>
<P>
</CENTER>
</BLOCKQUOTE>
</body>
</html>
